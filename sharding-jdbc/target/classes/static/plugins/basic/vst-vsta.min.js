var VST=VST||{},Common=Common||{},FileModelV1=FileModelV1||{},FileModelV2=FileModelV2||{},FileModel=FileModelV1;try{if(void 0===VSTOptions)var VSTOptions={}}catch(e){}!function(u){Common.getFileModel=function(){return"v1"==u.custom.fileModel.version?FileModelV1:"v2"==u.custom.fileModel.version?FileModelV2:void 0},Common.parseUrl=function(e){var n=document.createElement("a");return n.href=e,{protocol:n.protocol.replace(":",""),hostname:n.hostname,port:n.port,path:n.pathname,query:function(){for(var e=n.search.substr(1).split("&"),t={},i=0;i<e.length;i++){var a;t[(a=(a=e[i]).split("="))[0]]=a[1]}return t}(),params:n.hash.substr(1).split("#")}},Common.parseEvent=function(e){if(e)try{for(var t=e.split("."),i=null,a=0;a<t.length;a++)if(!(i=0==a?window[t[a]]:i[t[a]]))return null;return i}catch(e){return null}return null},Common.getCountDays=function(e,t){if(!e||!t)return null;var i=new Date(e+"-"+t),a=i.getMonth();return i.setMonth(a+1),i.setDate(0),i.getDate()},Common.isValid=function(e){return null!=e&&null!=e},Common.isNotValid=function(e){return null==e||null==e},Common.isNormal=function(e){return null!=e&&null!=e&&"null"!=e&&"undefined"!=e},Common.isNotNormal=function(e){return null==e||null==e||"null"==e||"undefined"==e},Common.isNotNull=function(e){return null!=e&&null!=e&&"null"!=e&&"undefined"!=e&&""!=e},Common.isNull=function(e){return null==e||null==e||"null"==e||"undefined"==e||""==e},Common.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},Common.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},Common.isString=function(e){return"[object String]"==Object.prototype.toString.call(e)},Common.isNumber=function(e){return"[object Number]"==Object.prototype.toString.call(e)},Common.isFunction=function(e){return"[object Function]"==Object.prototype.toString.call(e)},Common.dispatchEvent=function(e,t,i,a){if(e&&t){a=!!a;var n=null;try{n=new CustomEvent(t,{bubbles:a,cancelable:!0,detail:i})}catch(e){(n=document.createEvent("CustomEvent")).initCustomEvent(t,a,!0,i)}e.dispatchEvent(n)}},Common.getEasyuiDomAttr=function(e,t){var i;if(Common.isValid(e)){var a=u(e).attr("data-options");if(Common.isValid(a))for(var n=a.split(","),o=0;o<n.length;o++){var s=n[o].split(":");if(s&&2==s.length){var l=s[0].replace(/(^\s*)|(\s*$)/g,""),r=s[1].replace(/(^\s*)|(\s*$)/g,"");r=r&&r.replace(/(^'*)|(^"*)|('*$)|("*$)/g,""),l==t&&r&&("false"==r?r=!1:"true"==r&&(r=!0),i=r)}}var d=u(e).attr(t);d&&("false"==d?d=!1:"true"==d&&(d=!0),i=d)}return i},Common.parseDataOptions=function(e){var t={};if(Common.isValid(e)){var i=u(e).attr("data-options");if(Common.isValid(i))for(var a=i.split(","),n=0;n<a.length;n++){var o=a[n].split(":");if(o&&2==o.length){var s=o[0].replace(/(^\s*)|(\s*$)/g,""),l=o[1].replace(/(^\s*)|(\s*$)/g,"");"false"==(l=l&&l.replace(/(^'*)|(^"*)|('*$)|("*$)/g,""))?l=!1:"true"==l&&(l=!0),t[s]=l}}}return t},Common.getTimestampWithRandom=function(e){var t=""+(new Date).getTime();return e&&1<=e?t+Math.floor((9*Math.random()+1)*Math.pow(10,Math.floor(e)-1)):t},Common.getRandom=function(e){return e&&1<=e?Math.floor((9*Math.random()+1)*Math.pow(10,Math.floor(e)-1)):0},Common.getBrowserNV=function(){var e=navigator.userAgent.toLowerCase(),t="";return 0<e.indexOf("msie")&&(t=e.match(/msie [\d.]+/gi)),0<e.indexOf("firefox")&&(t=e.match(/firefox\/[\d.]+/gi)),0<e.indexOf("chrome")&&(t=e.match(/chrome\/[\d.]+/gi)),0<e.indexOf("safari")&&e.indexOf("chrome")<0&&(t=e.match(/safari\/[\d.]+/gi)),""==(t=t.toString())&&(t="Is not a standard browser"),-1==t.indexOf("firefox")&&-1==t.indexOf("chrome")||(t=t.replace("/","")),-1!=t.indexOf("msie")&&(t=t.replace("msie","ie").replace(/\s/g,"")),"Is not a standard browser"==t&&Common.isIE()&&(t="ie11.0"),t},Common.isIE=function(){return!!(window.ActiveXObject||"ActiveXObject"in window)},Common.getIEVersion=function(){if(Common.isIE()){new RegExp("MSIE (\\d+\\.\\d+);").test(userAgent);var e=parseFloat(RegExp.$1);return-1!=userAgent.indexOf("MSIE 6.0")?"IE6":7==e?"IE7":8==e?"IE8":9==e?"IE9":10==e?"IE10":userAgent.toLowerCase().match(/rv:([\d.]+)\) like gecko/)?"IE11":"0"}return"not ie browser"}}(jQuery),$.fn.pagination&&($.fn.pagination.defaults.beforePageText="第 ",$.fn.pagination.defaults.afterPageText="共 {pages} 页",$.fn.pagination.defaults.displayMsg="显示 {from} 到 {to},共 {total} 条记录",$.fn.pagination.defaults.layout=["list","sep","first","prev","manual","next","last","refresh","info"]),$.fn.datagrid&&($.fn.datagrid.defaults.loadMsg="正在处理，请稍候。。。",$.fn.datagrid.defaults.remoteSort=!0,$.fn.datagrid.defaults.pagination=!0,$.fn.datagrid.defaults.fit=!0,$.fn.datagrid.defaults.striped=!0,$.fn.datagrid.defaults.border=!1,$.fn.datagrid.defaults.fitColumns=!0,$.fn.datagrid.defaults.multiSort=!1),$.fn.datebox&&($.fn.datebox.defaults.height=26,$.fn.datebox.defaults.separator=".",$.fn.datebox.defaults.showcalendar=!1,$.fn.datebox.defaults.formatter=function(e){var t=e.getFullYear(),i=e.getMonth()+1,a=e.getDate();return t+$.fn.datebox.defaults.separator+(i<10?"0"+i:i)+$.fn.datebox.defaults.separator+(a<10?"0"+a:a)},$.fn.datebox.defaults.parser=function(e){if(!e)return new Date;var t=e.split($.fn.datebox.defaults.separator),i=parseInt(t[0]),a=parseInt(t[1]),n=parseInt(t[2]);return isNaN(i)||isNaN(a)||isNaN(n)?new Date:new Date(i,a-1,n)}),$.fn.form,$.fn.tabs&&($.fn.tabs.defaults.border=!1),$.map(["validatebox","textbox","passwordbox","filebox","searchbox","combo","combobox","combogrid","combotree","datebox","datetimebox","numberbox","spinner","numberspinner","timespinner","datetimespinner"],function(e){$.fn[e]&&($.fn[e].defaults.missingMessage="*")}),$.fn.validatebox&&($.fn.validatebox.defaults.placeable=!0,$.fn.validatebox.defaults.placeMissOnly=!0,$.fn.validatebox.defaults.tipable=!0,$.fn.validatebox.defaults.missingMsgForce="该输入项为必输项",$.fn.validatebox.defaults.validateOnBlur=!0,$.fn.validatebox.defaults.validateOnCreate=!0),$.fn.combobox&&($.fn.combobox.defaults.keySelectCycle=!0,$.fn.combobox.defaults.keySelectPannel=!0,$.fn.combo.defaults.editable=!1,$.extend($.fn.combobox.methods,{getSelected:function(e){$(e).combobox("options");return{value:$(e).combobox("getValue"),text:$(e).combobox("getText")}}})),$.fn.progressbar&&($.fn.progressbar.defaults.estimatedTime=1e3,$.fn.progressbar.defaults.intervalTime=1e3,$.fn.progressbar.defaults.autoComplete=!0),$.fn.textbox&&($.fn.textbox.defaults.height=26),$.fn.panel&&($.fn.panel.defaults.sizeMap={a:{width:400},b:{width:600},c:{width:950},full:{top:0,left:0,height:"100%",width:"100%"}});var easyuiPanelOnOpen=function(){var e=$(this).window("options");if(!e.forceSize){var t=e.size,i=$.fn.panel.defaults.sizeMap.a;if(t)for(var a in t=t.toLocaleLowerCase(),$.fn.panel.defaults.sizeMap)t==(a=a.toLocaleLowerCase())&&(i=$.fn.panel.defaults.sizeMap[a]);$(this).window("resize",i)}if(e.forcePosition&&"full"!=e.size){var n=$(this).parent().parent().width(),o=$(this).parent().parent().height(),s=$(this).parent().width(),l=$(this).parent().height();l<40&&Common.isNumber(e.expectHeight)&&(l=e.expectHeight);var r=(o-l)/2,d=(n-s)/2,u=r;0<r&&(u=Math.floor(2*r/3)),o<l&&(u=0),n<s&&(d=0),$(this).window("resize",{left:d,top:u})}};if($.fn.window&&($.fn.window.defaults.onOpen=easyuiPanelOnOpen,$.fn.window.defaults.forceSize=!1,$.fn.window.defaults.forcePosition=!0),$.fn.dialog&&($.fn.dialog.defaults.onOpen=easyuiPanelOnOpen,$.fn.dialog.defaults.forceSize=!1,$.fn.dialog.defaults.forcePosition=!0),$.parser){$.parser.completeFunctions=[];var parseComplete=function(){var e=[];if(Common.isArray($.parser.completeFunctions)){for(var t=$.parser.completeFunctions,i=0;i<t.length;i++){var a=t[i],n=a.func,o=a.onceFlag;Common.isFunction(n)&&(n.call(this),o||e.push(a))}$.parser.completeFunctions=e}};$.parser.onComplete=parseComplete}if(Common.isObject(VSTOptions)){var easyuiObj=VSTOptions.easyui;try{for(var key in easyuiObj)Common.isObject(easyuiObj[key])&&$.fn[key]&&Common.isObject($.fn[key].defaults)&&Common.isObject(easyuiObj[key].defaults)&&$.extend(!0,$.fn[key].defaults,easyuiObj[key].defaults)}catch(e){}}function extendVSTOptions(){if(Common.isObject(VSTOptions)){var e=VSTOptions.custom;Common.isObject(e)&&$.extend(!0,$.custom,e)}}$.custom={style:{},system:{},combobox:{},tabFocusScope:{},form:{},fileModel:{},enterSwitchFocus:{}},$.custom.system.fullScreenOpen=!1,$.custom.system.logoutClose=!1,$.custom.style.themeCookieName="vstui-theme",$.custom.style.fontCookieName="vstui-font",$.custom.style.path="/static/css/basic/layout",$.custom.style.filePrefix="/vst-layout-",$.custom.style.fileSuffix=".min.css",$.custom.style.linkThemeId="vstuiTheme",$.custom.style.fontData=[{key:"small",size:"12",desc:"小号字体"},{key:"normal",size:"14",desc:"中号字体(默认)"},{key:"large",size:"16",desc:"大号字体"},{key:"larger",size:"20",desc:"超大号字体"}],$.custom.style.themeData=[{key:"default",color:"#3a96c9",desc:"默认"},{key:"dazzlePurple",color:"#721cbf",desc:"炫彩紫"},{key:"emeraldGreen",color:"#2e9695",desc:"翡翠绿"},{key:"violetPurple",color:"#68307b",desc:"紫罗兰"},{key:"nightGreen",color:"#546f5e",desc:"夜幕绿"},{key:"green",color:"#039854",desc:"绿色"}],$.custom.style.defaultTheme="default",$.custom.style.defaultFont="normal",$.custom.style.cacheMsec=2592e6,$.custom.tabFocusScope.enable=!0,$.custom.tabFocusScope.cycleFocus=!0,$.custom.enterSwitchFocus.enable=!0,$.custom.enterSwitchFocus.cycleFocus=!0,$.custom.form.warnStyle="vst-validate-warn",$.custom.form.parentWarnStyle="vst-validate-warn-parent",$.custom.combobox.defauleInit=!0,$.custom.combobox.defauleSelectFirst=!0,$.custom.combobox.editable=!0,$.custom.combobox.dmAttrName="vst-combox",$.custom.combobox.subAttrName="vst-combox-sub",$.custom.combobox.supAttrName="vst-combox-sup",$.custom.combobox.valueField="DM",$.custom.combobox.textField="MC",$.custom.combobox.child="child",$.custom.fileModel.upload_multiple=!0,$.custom.fileModel.upload_input_info=!1,$.custom.fileModel.version="v1",extendVSTOptions(),function(i){VST.addLoadingEvent=function(e,t){Common.isFunction(e)&&(t=!!t),i.parser.completeFunctions.push({func:e,onceFlag:t})}}(jQuery),function(n){var i=n.ajax;n.ajax=function(e){var a={beforeSend:function(e,t){},complete:function(e,t){},error:function(e,t,i){},success:function(e,t){}};e.beforeSend&&(a.beforeSend=e.beforeSend),e.complete&&(a.complete=e.complete),e.error&&(a.error=e.error),e.success&&(a.success=e.success);var t=n.extend(e,{success:function(e,t,i){if(dataJson=e,Common.isString(e))try{dataJson=JSON.parse(e)}catch(e){}return 0==dataJson.flag&&dataJson.msg&&""!=dataJson.msg?(this.noMsg||n.messager.alert("错误提示",dataJson.msg,"error"),void a.error()):2==dataJson.flag&&dataJson.msg&&""!=dataJson.msg?(this.noMsg||n.messager.alert("警告提示",dataJson.msg,"warning"),void a.error()):(1==dataJson.flag&&dataJson.msg&&""!=dataJson.msg&&(this.noMsg||n.messager.alert("提示信息",dataJson.msg,"info")),void a.success.call(this,e,t,i))},beforeSend:function(e,t){e.setRequestHeader("If-Modified-Since","0"),e.setRequestHeader("Cache-Control","no-cache"),this.mask&&n.messager.progress({title:"温馨提示",msg:"",text:"数据正在处理中..."}),a.beforeSend.call(this,e,t)},complete:function(e,t){if(this.mask&&n.messager.progress("close"),a.complete.call(this,e,t),401==e.status){var i=e.responseText||"鉴权失败，需要重新登录，是否跳转到登录页?";n.messager.confirm("系统提示",i,function(e){e&&(top.location.href=basePath)})}}});i(t)}}(jQuery),function(v){var d=!0,g=0,b=0,x=0;function n(e,t){!function(e,t){var i=t.colNum,a=t.rowNum,n=t.gapNum,o=t.textHeight,s=t.data;if(!s||s.length<1)return;var l=v(e).height(),r=v(e).width();g=Math.floor((l-2*a*n)/a),b=Math.floor((r-2*i*n)/i),x=Math.min(b,g)-o-5;var d=i*a||0;v(e).empty(),v("<ul></ul>").appendTo(v(e));for(var u=0;u<d;u++){var f=Math.floor(u/i)+1,c=v('<li location="'+(p=f+"-"+(u%i+1))+'" class="box nothing" style="width:'+b+"px;height:"+g+"px;margin:"+n+'px;"></li>');v('<div class="item empty" style="width:'+b+"px;height:"+g+'px">').appendTo(c),c.appendTo(v(e).find(">ul"))}for(u=0;u<s.length;u++){var m=s[u];if(!(0<v(e).find("#"+m.qxdm).length)){var p=m.location;c=v(e).find("li.nothing:last");if(p&&0<p.indexOf("-")&&(c=v(e).find("li[location="+p+"]")),1==c.length){var h=w(m,t);c.empty(),c.removeClass("nothing"),h.appendTo(c),y(h,m,t),C(h,m,t)}}}}(e,t),function(r){v(r).find(".item").each(function(e){this.init=function(){this.box=v(this).parent(),v(this).attr("index",e).css({position:"absolute",left:this.box.position().left,top:this.box.position().top}).appendTo(v(r)),v(this).hasClass("empty")||this.drag()},this.move=function(e){v(this).stop(!0).animate({left:this.box.position().left,top:this.box.position().top},500,function(){e&&e.call(this)})},this.collisionCheck=function(){var a=this,n=null;v(this).siblings(".item").each(function(){var e=v(a).position(),t=e.left+b/2,i=e.top+g/2;t>this.box.position().left&&i>this.box.position().top&&t<this.box.position().left+this.box.width()&&i<this.box.position().top+this.box.height()&&(n=a.box.position().top<this.box.position().top?"down":a.box.position().top>this.box.position().top?"up":"normal",this.swap(a,n))})},this.swap=function(s,e){if(this.moveing)return!1;!function(e){v(".target-animation").removeClass("target-animation"),v(e).addClass("target-animation")}(this.box),{normal:function(){var e=this.box;this.box=s.box,s.box=e,this.move(),v(this).attr("index",this.box.index()),v(s).attr("index",s.box.index())},down:function(){var e=this.box,t=this,i=s.box.index(),a=t.box.index();l(r,i,a);for(var n=a;i<n;n--){var o=v(r).find(".item[index="+(n-1)+"]").get(0);if(!o)return;t.box=o.box,v(t).attr("index",t.box.index()),t.move(),t=o}s.box=e,v(s).attr("index",e.index())},up:function(){var e=this.box,t=this,i=t.box.index(),a=s.box.index();l(r,i,a);for(var n=i;n<a;n++){var o=v(r).find(" .item[index="+(n+1)+"]").get(0);if(!o)return;t.box=o.box,v(t).attr("index",t.box.index()),t.move(),t=o}s.box=e,v(s).attr("index",e.index())}}[e].call(this)},this.drag=function(){var n=new i,o=new u,s=!1,l=null;v(this).on("mousedown",function(e){2!=e.button&&v.data(r.get(0),"editable")&&(v(this).hasClass("empty")||(d=!0,e.preventDefault(),n.left=v(this).position().left,n.top=v(this).position().top,o.x=e.clientX,o.y=e.clientY,s=!0,l=this))}),v(r).mousemove(function(e){if(v.data(r.get(0),"editable")){var t=new u(e.clientX,e.clientY);if(!s)return!1;d=!1,v(l).css({opacity:"0.8","z-index":999});var i=t.x-o.x+n.left,a=t.y-o.y+n.top;v(l).css({left:i,top:a}),l.pointer=t,l.collisionCheck()}}),v(document).mouseup(function(e){if(2!=e.button&&v.data(r.get(0),"editable")){if(!s)return!1;s=!1,l.move(function(){v(this).css({opacity:"1","z-index":0})}),function(e){v(e).find(".over-animation").removeClass("over-animation"),v(".target-animation").removeClass("target-animation")}(r)}})},this.init()})}(e)}function w(e,t){var i=t.textHeight,a=e.icon;return a&&""!=a||(a=t.defaultIcon),v('<div class="item" title="'+e.qxmc+'" id="'+e.qxdm+'" url="'+e.url+'" style="width:'+b+"px;height:"+g+'px"><i class="item-img fa '+t.iconClass+'" style="height:'+x+"px;line-height:"+x+"px;width:"+x+'px" aria-hidden="true"></i><div class="item-text" style="line-height:'+i+'px">'+e.qxmc+"</div></div>")}function y(e,t,i){e.on("click",function(e){"function"==typeof i.onClickMenu&&d&&(i.onClickMenu.call(this,t,e),e.preventDefault(),e.stopPropagation())})}function C(t,i,a){t.on("contextmenu",function(e){if(v.data(t.parent().get(0),"editable"))return"function"==typeof a.onClickContextMenu?(a.onClickContextMenu.call(this,i,e),e.preventDefault(),void e.stopPropagation()):void 0})}function u(e,t){this.x=e,this.y=t}function i(e,t){this.left=e,this.top=t}function l(e,t,i){for(var a=i;t<=a;a--)v(v(e).find(".item[index="+a+"]").get(0).box).addClass("over-animation")}v.fn.favoriteMenu=function(e,t){if("string"==typeof e){var i=v.fn.favoriteMenu.methods[e];if(i)return i(this,t)}if("object"==typeof e){e=v.extend({data:[],editable:!1,colNum:3,rowNum:3,gapNum:0,iconClass:"fa-star",textHeight:25,defaultIcon:"images/menu/icon/1.png",onClickMenu:function(){},onClickContextMenu:function(){}},e),v.data(this.get(0),"favoriteMenuOptions",e);var a=e;v(this).data("options",a),n(this,e,t)}},v.fn.favoriteMenu.methods={remove:function(e,t){!function(e,t){var i=v("#"+t);i&&0<i.length&&(i.attr("url",null),i.attr("title",null),i.addClass("empty"),i.html(""),i.off("click"),i.off("contextmenu"))}(0,t)},reload:function(e,t){n(e,v.data(e.get(0),"favoriteMenuOptions"),t)},loadData:function(e,t){var i=v.data(e.get(0),"favoriteMenuOptions");i.data=t,v.data(e.get(0),"favoriteMenuOptions",i),n(e,i,t)},getData:function(e,t){return v.data(e.get(0),"favoriteMenuOptions").data},editable:function(e,t){return v.data(e.get(0),"editable",t)}}}(jQuery),function(t){function e(){var e=t(".easyui-layout");e&&0<e.length&&(e.hasClass("vst")&&e.layout("panel","north").panel("resize",{height:"auto"}),e.layout("resize",{height:"auto",width:"auto"}))}VST.addLoadingEvent(function(){e(),t(window).resize(function(){e()})}),VST.optimizeLayout=function(){e()}}(jQuery),function(d){d(function(){var r={types:"input:visible,select:visible,button:visible,a:visible:not(.textbox-icon),textarea:visible",separator:d.fn.datebox.defaults.separator,listener:function(e){var t=e.shiftKey,i=e.which,a=d.custom.enterSwitchFocus.cycleFocus,n=r.types,o=d(":focus").get(0),s=d(":focus").parents("form").find(n);if((o&&"A"!=o.tagName.toUpperCase()&&"BUTTON"!=o.tagName.toUpperCase()||t)&&"TEXTAREA"!=o.tagName.toUpperCase()&&13==i&&0<s.length){var l=s.index(o);if(l<0)return;t?0==l?a?r.setFocus(e,s,o,s.length-1):r.setFocus(e,s,o,0):r.setFocus(e,s,o,l-1):l==s.length-1?a?r.setFocus(e,s,o,0):r.setFocus(e,s,o,s.length-1):r.setFocus(e,s,o,l+1)}},setFocus:function(e,t,i,a){t[a].focus(),"INPUT"!=t[a].tagName.toUpperCase()&&"textarea"!=t[a].tagName.toUpperCase()||t[a].select(),d(i).parent().hasClass("combo")&&d(i).parent().prev().combo("hidePanel"),e.preventDefault(),e.stopPropagation()}};d.custom.enterSwitchFocus.enable&&(d("form").on("keydown",r.types,r.listener),d.fn.datebox&&d.extend(d.fn.datebox.defaults.keyHandler,{enter:function(e){var t=d(this).next("span.combo.datebox").find("input.textbox-text"),i=t.val();13===e.which&&(Common.isNull(i)&&(i=(new Date).format("yyyy"+r.separator+"MM"+r.separator+"dd")),t.val(i),t.next("input[type='hidden'].textbox-value").val(i),t.parent().prev(".easyui-datebox").datebox("hidePanel")),r.listener(e)}}),d.fn.datetimebox&&d.extend(d.fn.datetimebox.defaults.keyHandler,{enter:function(e){r.listener(e)}}),d.fn.combobox&&d.extend(d.fn.combobox.defaults.keyHandler,{enter:function(e){r.listener(e)}}),d.fn.combo&&d.extend(d.fn.combo.defaults.keyHandler,{enter:function(e){r.listener(e)}}))})}(jQuery),function(r){FileModelV1.initViewDomByDataId=function(e){u.initViewDomByDataId(e)},FileModelV1.getUploadFiles=function(){return u.getUploadFiles()},FileModelV1.initUploadPlugin=function(e){u.initUploadPlugin(e)},FileModelV1.restoreUploadPlugin=function(){u.restoreUploadPlugin(),u.initFileDom()},FileModelV1.showFiles=function(e){t.showFiles(e)},FileModelV1.downloadByFileId=function(e,t){o.downloadByFileId(e,t)},FileModelV1.downloadByDataId=function(e,t){o.downloadByDataId(e,t)},FileModelV1.downloadFilesByTableId=function(e){t.downloadFilesByTableId(e)},FileModelV1.deleteFile=function(e){u.deleteFile(e)},FileModelV1.deleteIntrinsicFile=function(e){u.deleteIntrinsicFile(e)},FileModelV1.uploadFile=function(e){u.uploadFile(e)};var u={uploadData:{batchNum:null,files:[],intrinsicFiles:[],deleteIntrinsicFiles:[]},initUploadPlugin:function(e){u.restoreUploadPlugin(),r(e).off("message"),r(e).on("message",function(e){u.previewFiles(e.originalEvent.data)}),r.custom.fileModel.upload_input_info&&r("#fileUploadContainer").parent().append(r('<input type="hidden" name="uploadInfo"/>')),u.initFileDom()},initFileDom:function(){r.ajax({url:"basic/files/getUploadInfo.do",type:"post",success:function(e){if(null!=e&&null!=e){if(null!=e.error)return void r.messager.alert("错误提示",e.error,"error");u.uploadData.batchNum=e.batchNum,u.saveUploadInfo(),r("#fileUploadContainer").html(""),u.addUploadDomWithData(e)}}})},restoreUploadPlugin:function(){u.uploadData={batchNum:null,files:[],intrinsicFiles:[],deleteIntrinsicFiles:[]},r("#fileViewContainer").html(""),r("#fileUploadContainer").html(""),u.saveUploadInfo()},addUploadDom:function(){r.ajax({url:"basic/files/getUploadInfo.do",type:"post",success:function(e){null!=e&&null!=e&&u.addUploadDomWithData(e)}})},addUploadDomWithData:function(e){if(null!=e&&null!=e){null==u.uploadData.batchNum&&(u.uploadData.batchNum=e.batchNum,u.saveUploadInfo());var t=r('<div class="upload-item current"></div>').appendTo("#fileUploadContainer"),i="multiple";r.custom.fileModel.upload_multiple||(i="");var a=""+(new Date).getTime()+Math.floor(1e3*(9*Math.random()+1));r('<iframe style="display:none" id="'+a+'" name="'+a+'">').appendTo(t),r('<form class="uploadform" target="'+a+'" action="'+e.url+'" method="post" enctype="multipart/form-data"><input type="hidden" name="username" value="'+e.username+'"><input type="hidden" name="authKey" value="'+e.authKey+'"><input type="hidden" name="batchNum" value="'+u.uploadData.batchNum+'"><input type="file" class="file-input" name="files" '+i+' onchange="FileModelV1.uploadFile(this)"><button type="button" class="btn vbtn file-button">添加附件</button></form>').appendTo(t)}},previewFiles:function(t){r("#fileViewContainer");var e=[];try{if(t&&0<t.length){t=JSON.parse(t);for(var i=0;i<t.length;i++){var a=t[i],n=r("#fileViewContainer .view-item[viewid="+u.Base64.encode(a.fileName)+"]");"success"==a.result?n&&u.completeProcess(n):(e.push(a.fileName),n&&u.failProcess(n)),u.uploadData.files.push(a);var o=r("#fileUploadContainer .upload-item[uploadid="+u.Base64.encode(a.fileName)+"]");o&&o.remove()}u.saveUploadInfo()}else r.messager.alert("警告提示","没有文件被上传","warning");0<e.length&&r.messager.alert("警告提示","有"+e.length+"个文件上传失败："+e.join(","),"warning")}catch(e){r.messager.alert("警告提示","上传文件出现异常,原始信息："+t,"warning")}},saveUploadInfo:function(){if(r.custom.fileModel.upload_input_info){var e=r("#fileUploadContainer").parent().find("[name=uploadInfo]");e&&e.val(u.getUploadFiles())}},uploadFile:function(e){var t=u.getFilesInfo(e);if(0<t.length){for(var i=0;i<t.length;i++)for(var a=0;a<u.uploadData.files.length;a++)if(u.uploadData.files[a].fileName==t[i].name)return r(e).val(""),void r.messager.alert("警告提示","您已经上传了文件:"+t[i].name,"warning");var n=r(e).parent("form.uploadform");n.submit(),u.addViewDom(t);var o=n.parent("div.upload-item");o.removeClass("current"),o.hide(),o.attr("uploadid",u.Base64.encode(t[0].name)),u.addUploadDom()}},initViewDomByDataId:function(e){r.ajax({url:"basic/files/getFileByDataId.do",type:"post",data:{id:e},success:function(e){null!=e&&null!=e&&u.addIntrinsicViewDom(e)}})},initViewDomByFileIds:function(e){var t="";t=Common.isArray(e)?e.join(","):e,r.ajax({url:"basic/files/getFileByFileIds.do",type:"post",data:{"string[]-ids":t},success:function(e){null!=e&&null!=e&&u.addIntrinsicViewDom(e)}})},addIntrinsicViewDom:function(e){for(var t=0;t<e.length;t++){var i=e[t];r('<div class="view-item intrinsic" id="'+i.ID+'"><div class="view-img '+i.TYPE+'"></div><div class="view-name" title="'+i.NAME+'">'+i.NAME+'</div><div class="view-opts"><a href="javascript:void(0)" class="opts-delete" onclick="FileModelV1.deleteIntrinsicFile(\''+i.ID+"')\">删除</a></div></div>").appendTo("#fileViewContainer"),u.uploadData.intrinsicFiles.push(i.ID),u.saveUploadInfo()}},addViewDom:function(e){for(var t=0;t<e.length;t++){var i=e[t];r('<div class="view-item" viewid="'+u.Base64.encode(i.name)+'"><div class="view-img '+i.type+'"></div><div class="view-name" title="'+i.name+'">'+i.name+'</div><div class="view-opts"><a href="javascript:void(0)" style="display:none" class="opts-delete" onclick="FileModelV1.deleteFile(\''+i.name+'\')">删除</a></div><div class="view-info"  style="display:none"><span class="info-size">'+i.size+'</span><span class="info-status">上传完成</span></div><div class="view-process"><div class="bar"><div class="complete" style="width:0%">'+i.size+',已上传:<span class="process-val">0%</span></div></div></div></div>').appendTo("#fileViewContainer")}},completeProcess:function(e){e&&(r(e).addClass("upload-success"),r(e).find(".view-process .complete").css("width","100%"),r(e).find(".view-process .complete .process-val").text("100%"),r(e).find(".view-opts .opts-delete").show(),r(e).find(".view-info").show(),r(e).find(".view-process").hide())},failProcess:function(e){e&&(r(e).addClass("upload-fail"),r(e).find(".view-process .complete").text("上传失败"))},deleteIntrinsicFile:function(i){r.messager.confirm("提示","原有附件，真的需要删除？",function(e){if(e){var t=r("#fileViewContainer .view-item.intrinsic#"+i);t&&t.remove(),u.uploadData.deleteIntrinsicFiles.push(i),u.saveUploadInfo()}})},deleteFile:function(a){var e={batchNum:u.uploadData.batchNum,deleteFileName:encodeURIComponent(a)};r.ajax({url:"basic/files/delete.do",data:e,mask:!0,success:function(e){if("1"==e){var t=r("#fileViewContainer .view-item[viewid="+u.Base64.encode(a)+"]");t&&t.remove();for(var i=0;i<u.uploadData.files.length;i++)if(u.uploadData.files[i].fileName==a){u.uploadData.files.splice(i,1);break}u.saveUploadInfo()}else r.messager.alert("警告提示","删除失败"+e,"warning")}})},getFilesInfo:function(e){var t=[];if(e.files)for(var i=0;i<e.files.length;i++){var a=e.files[i],n={},o=a.name;n.name=o;var s=a.size;s<1024?s+="B":s<1048576?s=Math.round(s/1024)+"KB":s<1073741824?s=(s/1048576).toFixed(2)+"MB":s<1099511627776&&(s=(s/1073741824).toFixed(2)+"GB"),n.size=s,0<o.indexOf(".")&&o.indexOf(".")<o.length-1&&(n.type=o.substring(o.lastIndexOf(".")+1)),t.push(n)}else{n={};var l=r(e).val();o=l.substring(l.lastIndexOf("\\")+1);1<(n.name=o).indexOf(".")&&o.indexOf(".")<o.length-1&&(n.type=o.substring(o.lastIndexOf(".")+1)),n.size="未知大小",t.push(n)}return t},getUploadFiles:function(){var e={batchNum:u.uploadData.batchNum,successFiles:[],failFiles:[],intrinsicFiles:u.uploadData.intrinsicFiles.join(","),deleteIntrinsicFiles:u.uploadData.deleteIntrinsicFiles.join(",")},t=u.uploadData.files;if(t&&0<t.length)for(var i=0;i<t.length;i++){var a=t[i];"success"==a.result?e.successFiles.push(encodeURIComponent(a.fileName)):e.failFiles.push(encodeURIComponent(a.fileName))}return e.successFiles=e.successFiles.join(","),e.failFiles=e.failFiles.join(","),JSON.stringify(e)},Base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",encode:function(e){var t,i,a,n,o,s,l,r="",d=0;for(e=u.Base64._utf8_encode(e);d<e.length;)n=(t=e.charCodeAt(d++))>>2,o=(3&t)<<4|(i=e.charCodeAt(d++))>>4,s=(15&i)<<2|(a=e.charCodeAt(d++))>>6,l=63&a,isNaN(i)?s=l=64:isNaN(a)&&(l=64),r=r+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return r},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var a=e.charCodeAt(i);a<128?t+=String.fromCharCode(a):(127<a&&a<2048?t+=String.fromCharCode(a>>6|192):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128)),t+=String.fromCharCode(63&a|128))}return t}}},t={showFiles:function(e){r("#winFiles").dialog({title:"附件列表",modal:!0,closed:!0,border:"thin",size:"b",height:400}),r("#viewFilesTable").datagrid({url:"basic/files/getFileForPageByDataId.do",queryParams:{id:e},cache:!1,fitColumns:!0,rownumbers:!0,striped:!0,sortName:"INSERTDATE",sortOrder:"desc",columns:[[{field:"NAME",title:"文件名称",sortable:!0,width:200,formatter:function(e,t,i){return'<a href="javascript:void(0)" title="'+t.NAME+'" onclick="FileModelV1.downloadByFileId(\''+t.ID+"')\">"+t.NAME+"</a>"}},{field:"INSERTDATE",title:"上传日期",align:"center",sortable:!0,width:120},{title:"id",field:"ID",width:100,checkbox:!0}]]}),r("#winFiles").dialog("open")},downloadFilesByTableId:function(e){var t=r("#"+e).datagrid("getSelections");if(t&&0<t.length){for(var i=[],a=0;a<t.length;a++){var n=t[a].ID;n&&""!=n&&i.push(n)}FileModelV1.downloadByFileId(i)}else r.messager.alert("提示","您没有选择任何文件！","info")}},o={paramKey:{files:"downloadFilePath",customNameParam:"customDownloaFileName",username:"username",authKey:"authKey"},downloadByFileId:function(e,t){var i="";i=Common.isArray(e)?e.join(","):e,r.ajax({url:"basic/files/getDownloadInfoByFileId.do",type:"post",data:{"string[]-ids":i},success:function(e){if(null!=e&&null!=e){if(null!=e.error)return void r.messager.alert("错误提示",e.error,"error");o.downloadPost(e,t)}}})},downloadByDataId:function(e,t){var i="";i=Common.isArray(e)?e.join(","):e,r.ajax({url:"basic/files/getDownloadInfoByDataId.do",type:"post",data:{"string[]-ids":i},success:function(e){if(null!=e&&null!=e){if(null!=e.error)return void r.messager.alert("错误提示",e.error,"error");o.downloadPost(e,t)}}})},downloadPost:function(e,t){if(e.url){if(!e.files)return void r.messager.alert("警告提示","没有指定下载文件!","warning");var i="downloadIframee7f0559c10aa",a=r("#"+i);(!a||a.length<1)&&(a=r('<iframe id="'+i+'" name="'+i+'" style="display:none">').appendTo("body"));var n=r('<form id="tempForm" style="display:none" target="'+i+'" action="'+e.url+'" method="post"><input type="text" name="'+o.paramKey.username+'" value="'+e.username+'"/><input type="text" name="'+o.paramKey.authKey+'" value="'+e.authKey+'"/><input type="text" name="'+o.paramKey.files+"\" value='"+encodeURIComponent(e.files)+'\'/><input type="text" name="'+o.paramKey.customNameParam+'" value="'+t+'"/></form>').appendTo("body");try{n.submit().remove()}catch(e){console.log(e)}}}}}(jQuery),function(r){FileModelV2.initViewDomByDataId=function(e,t){u.initViewDomByDataId(e,t)},FileModelV2.setEditAble=function(e){u.setEditAble(e)},FileModelV2.setBid=function(e){u.setBid(e)},FileModelV2.getUploadFiles=function(){return u.getUploadFiles()},FileModelV2.initUploadPlugin=function(e){u.initUploadPlugin(e)},FileModelV2.restoreUploadPlugin=function(){u.restoreUploadPlugin(),u.initFileDom()},FileModelV2.showFiles=function(e){FileModelV1.showFiles(e)},FileModelV2.downloadByFileId=function(e,t){FileModelV1.downloadByFileId(e,t)},FileModelV2.downloadByDataId=function(e,t){FileModelV1.downloadByDataId(e,t)},FileModelV2.downloadFilesByTableId=function(e){FileModelV1.downloadFilesByTableId(e)},FileModelV2.deleteFile=function(e){u.deleteFile(e)},FileModelV2.deleteIntrinsicFile=function(e){u.deleteIntrinsicFile(e)},FileModelV2.uploadFile=function(e){u.uploadFile(e)},FileModelV2.showFileInput=function(e){u.showFileInput(e)};var u={uploadData:{batchNum:null,files:[],intrinsicFiles:[],deleteIntrinsicFiles:[]},initUploadPlugin:function(e){u.restoreUploadPlugin(),r(e).off("message"),r(e).on("message",function(e){u.previewFiles(e.originalEvent.data)}),r.custom.fileModel.upload_input_info&&r("#fileUploadContainer").parent().append(r('<input type="hidden" name="uploadInfo"/>')),r("#fileUploadContainer,#fileViewContainer").addClass("v2"),u.initFileOpts(),u.initFileDom()},initFileOpts:function(){r("#fileViewContainer").hide();var e=r("#fileUploadContainer").parent(),t=r("<div class='btn-opts'>"),i=r('<i class="p-icon download fa fa-download" title="下载文件" aria-hidden="true"></i>'),n=r('<i class="p-icon compress fa fa-expand" title="查看/隐藏文件" aria-hidden="true"></i>');t.append(i),t.append(n),e.prepend(t),r('<div class="view-item-title"><div class="item f-index">序号</div><div class="item f-name">名称</div><div class="item f-opts">操作</div><div class="item f-date">上传日期</div></div>').appendTo("#fileViewContainer"),i.on("click",function(){var e=u.getBid();FileModelV2.downloadByDataId(e)}),n.on("click",function(){r("#fileViewContainer").slideToggle();var e=r("#fileUploadContainer").find(".upload-item.current input.file-input"),t=r("#fileUploadContainer").find(".upload-item.current .file-count"),i=r("#fileUploadContainer").find(".upload-item.current .file-button"),a=r("#fileViewContainer").find(">div.view-item.upload-success,>div.view-item.intrinsic").length;t.text(a),e.is(":visible")?(e.hide(),i.hide(),t.show(),n.addClass("fa-expand").removeClass("fa-compress")):(e.show(),i.show(),t.hide(),n.addClass("fa-compress").removeClass("fa-expand"))})},showFileInput:function(e){r(".btn-opts .p-icon.compress").trigger("click")},initFileDom:function(){r.ajax({url:"basic/files/getUploadInfo.do",type:"post",success:function(e){if(null!=e&&null!=e){if(null!=e.error)return void r.messager.alert("错误提示",e.error,"error");u.uploadData.batchNum=e.batchNum,u.saveUploadInfo(),r("#fileUploadContainer").html(""),u.addUploadDomWithData(e,!1)}}})},restoreUploadPlugin:function(){u.uploadData={batchNum:null,files:[],intrinsicFiles:[],deleteIntrinsicFiles:[]},r("#fileViewContainer").html(""),r("#fileUploadContainer").html(""),u.saveUploadInfo()},addUploadDom:function(){r.ajax({url:"basic/files/getUploadInfo.do",type:"post",success:function(e){null!=e&&null!=e&&u.addUploadDomWithData(e,!0)}})},addUploadDomWithData:function(e,t){if(null!=e&&null!=e){null==u.uploadData.batchNum&&(u.uploadData.batchNum=e.batchNum,u.saveUploadInfo());var i=r('<div class="upload-item current"></div>').appendTo("#fileUploadContainer"),a="multiple";r.custom.fileModel.upload_multiple||(a="");var n=""+(new Date).getTime()+Math.floor(1e3*(9*Math.random()+1)),o=(r('<iframe style="display:none" id="'+n+'" name="'+n+'">').appendTo(i),r('<form class="uploadform" target="'+n+'" action="'+e.url+'" method="post" enctype="multipart/form-data"><input type="hidden" name="username" value="'+e.username+'"><input type="hidden" name="authKey" value="'+e.authKey+'"><input type="hidden" name="batchNum" value="'+u.uploadData.batchNum+'"><input type="file" class="file-input" title="上传文件" style="display:none" name="files" '+a+' onchange="FileModelV2.uploadFile(this)"><span class="plug-title">附件信息</span><i class="file-button fa fa-plus-square" style="display:none"></i><span class="file-count label label-success" title="查看文件" onclick="FileModelV2.showFileInput(this)">0</span></form>').appendTo(i),r("#fileUploadContainer").find(".upload-item.current input.file-input")),s=r("#fileUploadContainer").find(".upload-item.current .file-count"),l=r("#fileUploadContainer").find(".upload-item.current .file-button");t?(o.show(),l.show(),s.hide()):(o.hide(),l.hide(),s.show())}},setEditAble:function(e){var t=r("#fileUploadContainer").find(".upload-item.current input.file-input");e?(t.removeAttr("disabled"),t.attr("title","上传文件"),r("#fileViewContainer").find(">div.view-item.intrinsic i.btn-delete").show()):(t.attr("disabled","disabled"),t.attr("title",""),r("#fileViewContainer").find(">div.view-item.intrinsic i.btn-delete").hide()),r("#fileUploadContainer").data("edit",e)},getEditAble:function(){return r("#fileUploadContainer").data("edit")},setBid:function(e){r("#fileUploadContainer").data("bid",e)},getBid:function(){return r("#fileUploadContainer").data("bid")},previewFiles:function(t){r("#fileViewContainer");var e=[];try{if(t&&0<t.length){t=JSON.parse(t);for(var i=0;i<t.length;i++){var a=t[i],n=r("#fileViewContainer .view-item[viewid="+u.Base64.encode(a.fileName)+"]");"success"==a.result?n&&u.completeProcess(n):(e.push(a.fileName),n&&u.failProcess(n)),u.uploadData.files.push(a);var o=r("#fileUploadContainer .upload-item[uploadid="+u.Base64.encode(a.fileName)+"]");o&&o.remove()}u.saveUploadInfo()}else r.messager.alert("警告提示","没有文件被上传","warning");0<e.length&&r.messager.alert("警告提示","有"+e.length+"个文件上传失败："+e.join(","),"warning")}catch(e){r.messager.alert("警告提示","上传文件出现异常,原始信息："+t,"warning")}},saveUploadInfo:function(){if(r.custom.fileModel.upload_input_info){var e=r("#fileUploadContainer").parent().find("[name=uploadInfo]");e&&e.val(u.getUploadFiles())}},uploadFile:function(e){var t=u.getFilesInfo(e);if(0<t.length){for(var i=0;i<t.length;i++)for(var a=0;a<u.uploadData.files.length;a++)if(u.uploadData.files[a].fileName==t[i].name)return r(e).val(""),void r.messager.alert("警告提示","您已经上传了文件:"+t[i].name,"warning");var n=r(e).parent("form.uploadform");n.submit(),u.addViewDom(t);var o=n.parent("div.upload-item");o.removeClass("current"),o.hide(),o.attr("uploadid",u.Base64.encode(t[0].name)),u.addUploadDom()}},initViewDomByDataId:function(e,t){r.ajax({url:"basic/files/getFileByDataId.do",type:"post",data:{id:e},success:function(e){null!=e&&null!=e&&u.addIntrinsicViewDom(e,t)}})},addIntrinsicViewDom:function(e,t){if(e&&0<e.length){for(var i=0;i<e.length;i++){var a=e[i];r('<div class="view-item intrinsic" id="'+a.ID+'"><div class="item f-index">'+(i+1)+'</div><div class="item f-name" title="'+a.NAME+'">'+a.NAME+'</div><div class="item f-opts"><i class="fa fa-download opt-btn btn-download" title="下载文件" onclick="FileModelV2.downloadByFileId(\''+a.ID+'\')"></i><i class="fa fa-minus-square opt-btn btn-delete" title="删除文件" style="'+(u.getEditAble()?"":"disabled:none")+'" onclick="FileModelV2.deleteIntrinsicFile(\''+a.ID+'\')"></i></div><div class="item f-date">'+a.INSERTDATE+"</div></div>").appendTo("#fileViewContainer"),u.uploadData.intrinsicFiles.push(a.ID),u.saveUploadInfo()}r("#fileUploadContainer .file-count").text(e.length)}},addViewDom:function(e){for(var t=r("#fileViewContainer").find(">div.view-item").length,i=0;i<e.length;i++){var a=e[i];r('<div class="view-item new" viewid="'+u.Base64.encode(a.name)+'"><div class="item f-index">'+(i+t+1)+'</div><div class="item f-name" title="'+a.name+'">'+a.name+'</div><div class="item f-opts"><i class="fa fa-minus-square opt-btn btn-delete" title="删除文件" onclick="FileModelV2.deleteFile(\''+a.name+'\')"></i></div><div class="item f-date">'+(new Date).format("yyyy-MM-dd")+'</div><div class="view-info"  style="display:none"><span class="info-size">'+a.size+'</span><span class="info-status">上传完成</span></div><div class="view-process"><div class="bar"><div class="complete" style="width:0%">'+a.size+',已上传:<span class="process-val">0%</span></div></div></div></div>').appendTo("#fileViewContainer")}},completeProcess:function(e){e&&(r(e).addClass("upload-success"),r(e).find(".view-process .complete").css("width","100%"),r(e).find(".view-process .complete .process-val").text("100%"),r(e).find(".view-opts .opts-delete").show(),r(e).find(".view-info").show(),r(e).find(".view-process").hide())},failProcess:function(e){e&&(r(e).addClass("upload-fail"),r(e).find(".view-process .complete").text("上传失败"))},deleteIntrinsicFile:function(i){r.messager.confirm("提示","原有附件，真的需要删除？",function(e){if(e){var t=r("#fileViewContainer .view-item.intrinsic#"+i);t&&t.remove(),u.resetIndex(),u.uploadData.deleteIntrinsicFiles.push(i),u.saveUploadInfo()}})},deleteFile:function(a){var e={batchNum:u.uploadData.batchNum,deleteFileName:encodeURIComponent(a)};r.ajax({url:"basic/files/delete.do",data:e,mask:!0,success:function(e){if("1"==e){var t=r("#fileViewContainer .view-item[viewid="+u.Base64.encode(a)+"]");t&&t.remove();for(var i=0;i<u.uploadData.files.length;i++)if(u.uploadData.files[i].fileName==a){u.uploadData.files.splice(i,1);break}u.saveUploadInfo(),u.resetIndex()}else r.messager.alert("警告提示","删除失败"+e,"warning")}})},resetIndex:function(){r("#fileViewContainer").find(">div.view-item").each(function(e){r(this).find(">div.f-index").text(e+1)})},getFilesInfo:function(e){var t=[];if(e.files)for(var i=0;i<e.files.length;i++){var a=e.files[i],n={},o=a.name;n.name=o;var s=a.size;s<1024?s+="B":s<1048576?s=Math.round(s/1024)+"KB":s<1073741824?s=(s/1048576).toFixed(2)+"MB":s<1099511627776&&(s=(s/1073741824).toFixed(2)+"GB"),n.size=s,0<o.indexOf(".")&&o.indexOf(".")<o.length-1&&(n.type=o.substring(o.lastIndexOf(".")+1)),t.push(n)}else{n={};var l=r(e).val();o=l.substring(l.lastIndexOf("\\")+1);1<(n.name=o).indexOf(".")&&o.indexOf(".")<o.length-1&&(n.type=o.substring(o.lastIndexOf(".")+1)),n.size="未知大小",t.push(n)}return t},getUploadFiles:function(){var e={batchNum:u.uploadData.batchNum,successFiles:[],failFiles:[],intrinsicFiles:u.uploadData.intrinsicFiles.join(","),deleteIntrinsicFiles:u.uploadData.deleteIntrinsicFiles.join(",")},t=u.uploadData.files;if(t&&0<t.length)for(var i=0;i<t.length;i++){var a=t[i];"success"==a.result?e.successFiles.push(encodeURIComponent(a.fileName)):e.failFiles.push(encodeURIComponent(a.fileName))}return e.successFiles=e.successFiles.join(","),e.failFiles=e.failFiles.join(","),JSON.stringify(e)},Base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",encode:function(e){var t,i,a,n,o,s,l,r="",d=0;for(e=u.Base64._utf8_encode(e);d<e.length;)n=(t=e.charCodeAt(d++))>>2,o=(3&t)<<4|(i=e.charCodeAt(d++))>>4,s=(15&i)<<2|(a=e.charCodeAt(d++))>>6,l=63&a,isNaN(i)?s=l=64:isNaN(a)&&(l=64),r=r+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return r},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var a=e.charCodeAt(i);a<128?t+=String.fromCharCode(a):(127<a&&a<2048?t+=String.fromCharCode(a>>6|192):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128)),t+=String.fromCharCode(63&a|128))}return t}}}}(jQuery),function(d){VST.addLoadingEvent(function(){d(function(){var i={maxFontNum:6,spaceH:20,spaceV:15,labelAlign:!0,labelPosition:"left",minLabelWidth:70};function s(e,t,i){var a=0;if(e&&0<e.length){e=function(e){for(var t=d(e.get(0)),i=0,a=0;a<e.length;a++){var n=d(e.get(a)).html();n&&n.length>i&&(i=n.length,t=d(e.get(a)))}return t}(e);var n=(new VST.SwitchStyle).getFontSize(),o=e.clone();o.css("font-size",n+"px"),t&&o.text(t);var s=d("<form>").addClass("vst-form");s.css({position:"absolute","z-index":-1}),o.appendTo(s),s.appendTo("body");var l=o.width(),r=0;i&&(r=Number(o.css("margin-left").replace("px",""))+Number(o.css("margin-right").replace("px",""))),a=l+r,s.remove()}return a}d(".vst-form").each(function(e){if(!d(this).data("hasAdjust")){d(this).data("hasAdjust",!0);var t=Common.parseDataOptions(this),n=d.extend(!0,{},i,d.custom.form,t);if(n.labelAlign){var o=0;d(this).find("div>.vst-form-span").each(function(e){d(this).hasClass("left")||d(this).hasClass("center")||d(this).hasClass("right")||d(this).addClass(n.labelPosition);for(var t="",i=0;i<n.maxFontNum;i++)t+="大";var a=0;a=d(this).text().length<=n.maxFontNum?s(d(this)):s(d(this),t),o<a&&(o=a)}),1<(o=o<1?n.minLabelWidth:o+2)&&d(this).find("div>.vst-form-span").each(function(e){d(this).css("width",o)})}d(this).find("div.lineDiv,div.newlineDiv").each(function(){var e=n.spaceH;(d(this).hasClass("no-margin")||d(this).hasClass("newlineDiv"))&&(e=0),d(this).css("margin-right",e+"px"),d(this).css("margin-bottom",n.spaceV+"px")}),VST.optimizeLayout()}})})})}(jQuery),function(i){VST.initWidget=function(e){if(Common.isNull(e))return"selector is invalid!";var t=i(e);if(Common.isNotValid(t)||t.length<1)return"selector for dom is null!";try{!function(e){var t=i(e).find("select["+i.custom.combobox.dmAttrName+"],input["+i.custom.combobox.dmAttrName+"]");VST.initComboxDM({selector:t,thisAuto:!0,onComplete:function(){}})}(e)}catch(e){}try{!function(e){VST.initDateBoxManual(i(e))}(e)}catch(e){}try{VST.initLayDateManual(e)}catch(e){}}}(jQuery),$.extend({addQX:function(e,t){if(this.resetQX(e,t),$("#"+e+"Flag").length<1){var i=$("#"+e);i.append($('<input id="'+e+'Flag" type="hidden" >'));var a=this;$("#"+t+"QX").length<1&&$("#"+t).append($('<input id="'+t+'QX" name="'+t+'QX" type="hidden" value="0" >')),$("body").append('<div id="'+e+'dgBtn" title="全部" > <span style="display: block; margin-left: 5px; margin-top: -5px;" > <input id="'+e+'Box" type="checkbox"  value="0" ></span> </div>'),$("#"+e+"Box").click(function(){a._handerQXVal(e,t)}),i.datagrid("getPager").pagination({buttons:"#"+e+"dgBtn"}),$("#"+e+"dgBtn").parent().parent().find("td:first").before($("#"+e+"dgBtn").parent())}},_handerQXVal:function(e,t){var i=$("#"+e),a=$("#"+e+"dgBtn"),n=$("#"+e+"Box");1==n.val()?(a.attr("title","非全部"),$("#"+t+"QX").val(0),n.val(0),i.datagrid("unselectAll")):(a.attr("title","全部"),$("#"+t+"QX").val(1),n.val(1),i.datagrid("selectAll"))},resetQX:function(e,t){var i=$("#"+e+"Box");i.attr("checked",!1),i.attr("title","全部"),$("#"+t+"QX").val(0),$("#"+e+"Box").val(0),$("#"+e).datagrid("unselectAll")},downFile:function(e,t){var i=$("form[id='fileCommonForm']");i.length<1?(i=$("<form id='fileCommonForm' method='post' action='"+e+"' style='display: none;' ></form>")).appendTo($("body")):(i.empty(),i.attr("action",e)),$.each(t,function(e,t){$("<input name='"+e+"' value='"+t+"' type='hidden'>").appendTo(i)}),i.submit()}}),function(V){V.fn.mrkMenu=function(e,t){if(!(V(this).length<1)){if("string"==typeof e){var i=V.fn.mrkMenu.methods[e];if(i)return i(this,t)}!function(e,t){var i={menuStartIndex:1,searchText:"",originData:t.menuData,originTarget:e,originMenuRootId:t.menuRootId,directoryVal:"1",groupVal:"11",moduleVal:"2",searchPid:"search-root"},a=V.extend({},V.fn.mrkMenu.defaultOptions);M=V.extend(!0,a,t,i)}(this,e),function(e){var a=e.menuData;V.grep(a,function(e){if(e.mkbz==M.directoryVal&&e.sjqxdm!=M.menuRootId){var t=e.qxdm,i=!0;V.grep(a,function(e){e.sjqxdm==t&&e.mkbz!=M.moduleVal&&(i=!1)}),i&&(e.mkbz=M.groupVal,e.ex_originMkbz=M.directoryVal)}}),M.menuData=a}(M),function(e){e.html(""),M.horizontal&&e.addClass("horizontal");M.flotable&&e.addClass("floating");(function x(w,y,t,C){var l="md";var F="mt";var D="mdt";var i={};var S=y;if(void 0===y||null==y)return;M.groupInOneCol&&S.addClass("goc");M.horizontal&&M.flotable&&Common.isNumber(M.flotHeight)&&S.css("max-height",M.flotHeight+"px");M.flotable||(D=F="");C==M.menuStartIndex&&((y=V("<ul />").addClass("menu-root").attr("id","menuRoot").appendTo(y)).addClass("treeview-level-"+C++),y.html(""),""!=M.headerText&&M.headerText&&y.append('<li id="menuHead" class="header">'+M.headerText+"</li>"));var e=M.menuData;var a=V.grep(e,function(e){if(e.qxdm==t&&(i=e),e.sjqxdm==t&&(e.mkbz==M.moduleVal&&!M.flotable||e.mkbz==M.directoryVal||e.mkbz==M.groupVal))return!0});var I=0;var n=0;var o=!1;var s=V.grep(e,function(e){return!(e.sjqxdm!=t||e.mkbz==M.directoryVal||!M.flotable)&&(e.mkbz==M.moduleVal&&e.xh>I&&(I=e.xh),e.mkbz==M.groupVal&&e.xh>n&&(n=e.xh),i.mkbz!=M.directoryVal||e.mkbz!=M.moduleVal||(e.sjqxdm="unknown-group-"+t,!(o=!0)))});o&&s.push({qxdm:"unknown-group-"+t,sjqxdm:t,qxmc:M.unknownGroupTitle,icon:M.unknownGroupIcon,url:"",mkbz:M.groupVal,xh:n+1});if(!a.length&&!s.length)return;a.sort(function(e,t){return e.xh-t.xh});s.sort(function(e,t){return e.xh-t.xh});i.mkbz!=M.directoryVal&&M.flotable?i.mkbz==M.groupVal?(y.addClass(D),y.addClass(F)):i.mkbz==M.moduleVal&&y.addClass(F):y.addClass(l);V.each(a,function(){var i=this,e="directory",s=!1;i.mkbz==M.moduleVal?(e="module",s=!0):i.mkbz==M.groupVal&&(e="group");var a=V("<li />").addClass("treeview md").appendTo(y);V("<div/>").addClass("hover-sign md").appendTo(a);var t=V("<a/>").attr({href:this.url||"javascript:void(0)",menuid:this.qxdm}).addClass(""===this.url?"":"menu-item").addClass(l).addClass(e).appendTo(a);this.icon&&M.showIcon?this.icon.indexOf("/")<0&&0<this.icon.indexOf("fa-")?V("<i/>").addClass("md fa "+this.icon||"").appendTo(t):V("<img/>").attr("src",this.icon).addClass("text-icon md").appendTo(t):t.addClass("no-icon"),V('<span class="menu-title md" />').text(this.qxmc).appendTo(t);var n=V('<ul class="treeview-menu fold-menu" />');if(Common.isNumber(M.itemWidth)&&2<C&&a.css("width",M.itemWidth+"px"),x(a,n,i.qxdm,C+1),n.children().length){a.addClass("dropdown-menus"),n.addClass("treeview-level-"+C);var o=(C-1)*Number(M.retract)+M.retractAdded;n.find(">li>a").css("padding-left",o+"px"),n.appendTo(a),t.attr("href","javascript:void(0)"),t.removeClass("menu-item"),s||V('<span class="arrow fold md"></span>').appendTo(a),t.on("contextmenu",function(e){M.onClickContextMenu.call(a,{isModule:s,data:i,e:e}),e.preventDefault(),e.stopPropagation()}),a.on("click",function(e){if(e.preventDefault(),e.stopPropagation(),!V(e.target).is("ul")){if(s&&M.autoHideflot&&V(".mdt.flot-menu").hide(),M.onClickMenu.call(a,{isModule:s,data:i,e:e}),M.originTarget.find("li>a").removeClass("selected"),V(this).find(">a").addClass("selected"),V(this).parentsUntil(M.originTarget,"li").find(">a").addClass("selected"),V(this).hasClass("open")){var t="";M.remberSonFoldState?(V(this).find(">ul.fold-menu").slideUp(M.foldTime),V(this).removeClass("open")):(V(this).find(">ul.fold-menu").slideUp(M.foldTime),V(this).removeClass("open"),V(this).find("li.open.md>ul.fold-menu").slideUp(M.foldTime),V(this).find("li.open.md").removeClass("open"))}else{if(M.onlyUnfold){var t="";t=M.remberSonFoldState?">li.open.md":"li.open.md",a.parent().find(t).find(">ul.fold-menu").slideUp(M.foldTime),a.parent().find(t).removeClass("open")}a.find(">ul.fold-menu").slideDown(M.unFoldTime),V(this).addClass("open")}V(this).hasClass("flot-open")?M.horizontal&&M.flotable&&(V(this).removeClass("flot-open"),V(this).find(">ul.flot-menu").slideUp(0)):(M.originTarget.find("li.md").removeClass("flot-open"),M.originTarget.find("ul.flot-menu").slideUp(0),V(this).addClass("flot-open"),V(this).find(">ul.flot-menu").slideDown(0,function(){if(!s&&M.horizontal&&M.flotable){var e=V(this).parent().offset().left+V(this).parent().outerWidth()/2,t=V(this).parent().find(">a").offset().left,i=V(this).parent().find(">a").width(),a=V(this).find("div.treeview.group").length*V(this).find(">.flot-column").outerWidth(),n=V(document).width();V(this).parent().find(">.hover-sign").css({left:t+"px",width:i+"px"});var o=!0;n<e+a/2&&(o=!1,V(this).css("right","3px"),V(this).css("left","auto"),V(this).css("margin","auto")),e-a/2<0&&(o=!1,V(this).css("left","3px"),V(this).css("right","auto"),V(this).css("margin","auto")),o&&V(this).css({left:e-a/2+"px",right:"auto",margin:"auto"}),V(this).find(">.seperator").css({top:V(this).offset().top+20+"px",height:V(this).outerHeight()-40+"px"})}}))}})}else s||V('<span class="arrow fold md '+D+'"></span>').appendTo(a),t.on("contextmenu",function(e){M.onClickContextMenu.call(a,{isModule:s,data:i,e:e}),e.preventDefault(),e.stopPropagation()}),a.on("click",function(e){if(s&&M.autoHideflot&&V(".mdt.flot-menu").hide(),M.onClickMenu.call(a,{isModule:s,data:i,e:e}),M.originTarget.find("li>a").removeClass("selected"),V(this).find(">a").addClass("selected"),V(this).parentsUntil(M.originTarget,"li").find(">a").addClass("selected"),M.onlyUnfold){var t="";t=M.remberSonFoldState?">li.open.md":"li.open.md",a.parent().find(t).find(">ul.fold-menu").slideUp(M.foldTime),a.parent().find(t).removeClass("open")}V(this).hasClass("flot-open")?M.horizontal&&M.flotable&&(V(this).removeClass("flot-open"),V(this).find(">ul.flot-menu").slideUp(0)):(M.originTarget.find("li.md").removeClass("flot-open"),M.originTarget.find("ul.flot-menu").slideUp(0),V(this).addClass("flot-open"),V(this).find(">ul.flot-menu").slideDown(0,function(){if(!s&&M.horizontal&&M.flotable){var e=V(this).parent().offset().left+V(this).parent().outerWidth()/2,t=V(this).parent().find(">a").offset().left,i=V(this).parent().find(">a").width(),a=V(this).find("div.treeview.group").length*V(this).find(">.flot-column").outerWidth(),n=V(document).width();V(this).parent().find(">.hover-sign").css({left:t+"px",width:i+"px"});var o=!0;n<e+a/2&&(o=!1,V(this).css("right","3px"),V(this).css("left","auto"),V(this).css("margin","auto")),e-a/2<0&&(o=!1,V(this).css("left","3px"),V(this).css("right","auto"),V(this).css("margin","auto")),o&&V(this).css({left:e-a/2+"px",right:"auto",margin:"auto"}),V(this).find(">.seperator").css({top:V(this).offset().top+20+"px",height:V(this).outerHeight()-40+"px"})}})),e.preventDefault(),e.stopPropagation()});a.hover(function(e){M.originTarget.find("li.md").removeClass("hover-on"),V(this).addClass("hover-on"),M.horizontal&&M.flotable&&M.hfHoverShow&&(M.originTarget.find("li.md").removeClass("flot-open"),M.originTarget.find("ul.flot-menu").slideUp(0),V(this).addClass("flot-open"),V(this).find(">ul.flot-menu").slideDown(0,function(){if(!s&&M.horizontal&&M.flotable){var e=V(this).parent().offset().left+V(this).parent().outerWidth()/2,t=V(this).parent().find(">a").offset().left,i=V(this).parent().find(">a").width(),a=V(this).find("div.treeview.group").length*V(this).find(">.flot-column").outerWidth(),n=V(document).width();V(this).parent().find(">.hover-sign").css({left:t+"px",width:i+"px"});var o=!0;n<e+a/2&&(o=!1,V(this).css("right","3px"),V(this).css("left","auto"),V(this).css("margin","auto")),e-a/2<0&&(o=!1,V(this).css("left","3px"),V(this).css("right","auto"),V(this).css("margin","auto")),o&&V(this).css({left:e-a/2+"px",right:"auto",margin:"auto"}),V(this).find(">.seperator").css({top:V(this).offset().top+20+"px",height:V(this).outerHeight()-40+"px"})}})),e.preventDefault(),e.stopPropagation()},function(e){M.originTarget.find("li.md").removeClass("hover-on"),V(this).prev("li").length||V(this).parent("ul").parent("li").addClass("hover-on"),M.horizontal&&M.flotable&&M.hfHoverShow&&(V(this).removeClass("flot-open"),V(this).find(">ul.flot-menu").slideUp(0))})});V.each(s,function(e,t){var i=this,a="group",n=i.qxdm,o=!1;i.mkbz==M.moduleVal&&(o=!0,n=i.sjqxdm,a="module");var s=F;if(y.hasClass(D)&&(s=F+" "+D),S.hasClass("flot-menu"))if(!o&&M.groupInOneCol){S.find(".last-column").removeClass("last-column"),V("<div />").addClass("flot-column seperator").appendTo(S);var l=V("<div />").addClass("flot-column last-column").appendTo(S);y=l}else{var r=(y=S.find("div.flot-column:last")).find("div.last-module").length;this.xh==I&&(r+=1);var d=r*M.groupGapHeight,u=V("#menuRoot").innerHeight();Common.isNumber(M.flotHeight)&&(u=M.flotHeight);var f=u-M.outerHeight,c=y.find("div.treeview").length*M.itemHeight;if(!M.groupInOneCol&&f-c-d<M.itemHeight){S.find(".last-column").removeClass("last-column");var l=V("<div />").addClass("flot-column last-column").appendTo(S);y=l}if(M.groupInOneCol){var m=y.data("sonColNum")?y.data("sonColNum"):1;if(f-c/m-d<M.itemHeight){y.data("sonColNum",m+1);var p=y.find(">div.treeview:last").width();y.css("width",y.width()+p+"px")}}}else{(S=V('<ul class="treeview-menu mt mdt flot-menu"/>').appendTo(w)).addClass("flot-menu"),S.addClass("treeview-level-"+C-1);var l=V("<div />").addClass("flot-column last-column").appendTo(S);y=l}var h=V("<div />").addClass("treeview "+s+" "+a).attr("groupId",n).appendTo(y);if(this.xh==I&&h.addClass("last-module"),Common.isNumber(M.itemWidth)&&h.css("width",M.itemWidth+"px"),M.groupInOneCol){var v=h.width(),g=y.width();g<v&&y.css("width",v)}V("<div/>").addClass("hover-sign "+s+" "+a).attr("groupId",n).appendTo(h);var b=V("<a/>").attr({href:this.url||"#",menuid:this.qxdm}).addClass(""===this.url?"":"menu-item").addClass(s+" "+a).attr("groupId",n).appendTo(h);this.icon&&M.showIcon?this.icon.indexOf("/")<0&&0<this.icon.indexOf("fa-")?V("<i/>").addClass("md fa "+this.icon||"").appendTo(b):V("<img/>").attr("src",this.icon).addClass("text-icon md").appendTo(b):b.addClass("no-icon"),V('<span class="menu-title '+s+" "+a+'" />').attr("groupId",n).text(this.qxmc).appendTo(b),x(w,S,i.qxdm,C+1),h.on("click",function(e){o&&M.autoHideflot&&V(".mdt.flot-menu").hide(),M.onClickMenu.call(h,{isModule:o,data:i,e:e}),e.preventDefault(),e.stopPropagation()}),b.on("contextmenu",function(e){M.onClickContextMenu.call(h,{isModule:o,data:i,e:e}),e.preventDefault(),e.stopPropagation()}),h.hover(function(e){M.originTarget.find("div.mt").removeClass("hover-on"),V(this).addClass("hover-on");var t=h.attr("groupId");V("div[groupId='"+t+"']").addClass("group-hover"),V(this).parent(".flot-column").addClass("col-hover"),e.preventDefault(),e.stopPropagation()},function(e){M.originTarget.find("div.mt").removeClass("hover-on");var t=h.attr("groupId");V("div[groupId='"+t+"']").removeClass("group-hover"),V(this).parent(".flot-column").removeClass("col-hover")})})})(null,e,M.menuRootId,M.menuStartIndex),M.horizontal&&M.flotable&&function(e){var t=V(e).find("ul.menu-root >li");if(e.css("left","0px"),t&&0<t.length){var i=e.parent().width(),a=0,n=t.length;t.each(function(e){a+=V(this).width()}),(i-a)/n<10?t.css("padding","3px 5px"):(i-a)/n<80?t.css("padding","3px "+(i-a)/(2*n)+"px"):(t.css("padding","3px 40px"),e.css("left",(i-e.outerWidth())/2+"px"),e.css("margin","0px")),e.css("min-width",e.outerWidth()<1024?1024:e.outerWidth()+"px")}}(e);M.onComplete.call(this)}(this)}},V.fn.mrkMenu.methods={search:function(e,t){return"method deprecated"},getFilterData:function(e,t){return i(M.originData,t)},getAutoCompleteFilterData:function(e,t){return"method deprecated"}},V.fn.mrkMenu.defaultOptions={menuData:[],menuRootId:"",retract:28,retractAdded:6,itemHeight:35,flotHeight:500,groupGapHeight:20,outerHeight:20,headerText:"",unFoldTime:200,foldTime:200,remberSonFoldState:!0,onlyUnfold:!0,autoHideflot:!0,unknownGroupTitle:"未分组",flotable:!1,groupInOneCol:!0,hfHoverShow:!0,unknownGroupIcon:"",onComplete:function(e){},onClickMenu:function(e){},onClickContextMenu:function(e){}};var M=V.fn.mrkMenu.defaultOptions;function i(e,t){if(null==t||null==t||""==t)return e;for(var i=[],a=new RegExp(t),n=0;n<e.length;n++){var o=e[n];a.test(o.qxmc)&&!s(e,o.qxdm)&&(o.sjqxdm=M.searchPid,i.push(o))}return i}function s(e,t){for(var i=0;i<e.length;i++){if(e[i].sjqxdm==t)return!0}return!1}}(jQuery),jQuery,String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},Array.prototype.S=String.fromCharCode(2),Array.prototype.contain=function(e){return new RegExp(this.S+e+this.S).test(this.S+this.join(this.S)+this.S)},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"a+":12<=this.getHours()?"下午":"上午",S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"}[this.getDay()+""]:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"}[this.getDay()+""])),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},function(a){var i="ueditorObjectBindingKey";a.fn.richText=function(e,t){if(!(a(this).length<1)&&"string"==typeof e){var i=a.fn.richText.methods[e];if(i)return i(this,t)}},a.fn.richText.methods={getEditor:function(e){return a(e).data(i)},setEditor:function(e,t){return a(e).data(i,t),t}}}(jQuery),function(l){VST.SwitchStyle=function(){this.vstui_cookie_theme=l.custom.style.themeCookieName,this.vstui_cookie_font=l.custom.style.fontCookieName,this.link_theme_id=l.custom.style.linkThemeId,this.vstui_pathPrefix=l.custom.style.path+l.custom.style.filePrefix,this.vstui_pathSuffix=l.custom.style.fileSuffix,this.fontData=l.custom.style.fontData,this.themeData=l.custom.style.themeData,this.defaultTheme=l.custom.style.defaultTheme,this.defaultFont=l.custom.style.defaultFont,this.cacheMsec=l.custom.style.cacheMsec,this.initStyle=function(){this.setStyle(this.getStyle())},this.getTheme=function(){var e=Cookies.get(this.vstui_cookie_theme);return this.validateValue(e,this.themeData)||(e=this.defaultTheme),e},this.getFont=function(){var e=Cookies.get(this.vstui_cookie_font);return this.validateValue(e,this.fontData)||(e=this.defaultFont),e},this.validateValue=function(e,t){if(!t||t.length<1)return!1;for(var i=0;i<t.length;i++)if(t[i].key==e)return!0;return!1},this.getStyle=function(){var e=this.getTheme(),t=this.getFont();return t=t||this.defaultFont,(e=e||this.defaultTheme)+"-"+t},this.getStyleUrl=function(){var e=this.getStyle();return this.vstui_pathPrefix+e+this.vstui_pathSuffix},this.getStyleName=function(){return this.getStyle()+this.vstui_pathSuffix},this.getFontSize=function(){for(var e=this.getFont(),t=this.fontData,i=0;i<t.length;i++)if(t[i].key==e)return t[i].size},this.getThemeColor=function(){for(var e=this.getTheme(),t=this.themeData,i=0;i<t.length;i++)if(t[i].key==e)return t[i].color},this.setTheme=function(e,t){if(this.validateValue(e,this.themeData)){var i={path:"/"};if(this.cacheMsec){var a=new Date;a.setTime((new Date).getTime()+this.cacheMsec),i.expires=a}if(Cookies.set(this.vstui_cookie_theme,e,i),t){var n=e+"-"+this.getFont();this.setStyle(n)}}},this.setFont=function(e,t){if(this.validateValue(e,this.fontData)){var i={path:"/"};if(this.cacheMsec){var a=new Date;a.setTime((new Date).getTime()+this.cacheMsec),i.expires=a}if(Cookies.set(this.vstui_cookie_font,e,i),t){var n=this.getTheme()+"-"+e;this.setStyle(n)}}},this.setStyle=function(e){var t=e.split("-");2==t.length&&(this.setTheme(t[0]),this.setFont(t[1]));var i=l("body").attr("theme");l(window.top.document).find("body").removeClass(i).addClass(e),l(window.top.document).find("body").attr("theme",e);var a=""+path+this.vstui_pathPrefix+e+this.vstui_pathSuffix;l(window.top.document).find("link#"+this.link_theme_id).attr("href",a),this._setIframeLink(window.top.document,a,i,e)},this._setIframeLink=function(e,t,i,a){var n=e.getElementsByTagName("iframe");if(!(n.length<1))for(var o=0;o<n.length;o++){var s=n[o].contentWindow.document;l(s).find("body").removeClass(i).addClass(a),l(s).find("body").attr("theme",a),l(s).find("link#"+this.link_theme_id).attr("href",t),this._setIframeLink(s,t,i,a)}}}}(jQuery),function(r){VST.addTabFocusScope=function(e,t){var i=function(s,l){return function(e){var t=e.shiftKey,i=e.which,a=r(":focus"),n=r(this);if(9==i&&(Common.isNotValid(l)&&r.custom.tabFocusScope.cycleFocus,0<a.parents(s).length&&(n=a.parents(s)),r.contains(n.get(0),a.get(0)))){var o=n.find("input:visible,select:visible,button:visible,a:visible,textarea:visible");a.get(0)==o.get(o.length-1)?t||(l?o.get(0).focus():o.get(o.length-1).focus(),e.preventDefault()):a.get(0)==o.get(0)&&t&&(l?o.get(o.length-1).focus():o.get(0).focus(),e.preventDefault())}}}(e,t);r(document).on("keydown",i)},r(function(){r.custom.tabFocusScope.enable&&VST.addTabFocusScope("document",r.custom.tabFocusScope.cycleFocus)})}(jQuery),function(u){function n(e,t,i){u(e).hide();var a=u(e).parents("body"),n=u('<div class="vst-window full" style="display:none">').appendTo(a),o=u('<div class="vst-window-header">'),s=u('<div class="head-back" title="返回"><i id="headBack" class="back-img fa fa-chevron-left"></i></div>'),l=u('<div class="head-title">'+t.title||"</div>");o.append(s),o.append(l),s.on("click",function(){f(e,i)}),u(e).attr("style",null),u(e).addClass("vst-window-content"),u(e).appendTo(n);var r=u('<div class="vst-window-footer">'),d=u(e).find("div.buttonDiv");d&&0<d.length?d.appendTo(r):(d=u(t.buttons))&&0<d.length&&d.appendTo(r),d&&0<d.length?r.appendTo(n):t.showHead=!0,t.showHead?o.prependTo(n):n.addClass("no-head"),t.openState&&(n.show(),u(e).show())}function o(e){var t=u.data(u(e).get(0),"vstwindow"),i=u(e).parent(".vst-window.full");i&&1==i.length?(u(e).show(),i.show(),t.onOpen.call(this)):console.log("has not init")}function f(e){var t=u.data(u(e).get(0),"vstwindow"),i=u(e).parent(".vst-window.full");i&&1==i.length?(i.hide(),t.onClose.call(this)):console.log("has not init")}u.fn.vstwindow=function(e,t){if(!(u(this).length<1)){if("string"==typeof e){var i=u.fn.vstwindow.methods[e];if(i)return i(this,t)}if("object"==typeof e||null==e){e=u.extend({showHead:!1,openState:!0,onOpen:function(){},onClose:function(){}},e);var a=u.data(this.get(0),"vstwindow");u.data(this.get(0),"vstwindow",e),function(t,i,a,e){e?o(t,a):i&&i.href?u.ajax({url:i.href,success:function(e){u(t).append(e),VST.initWidget(t),u.parser.parse(t),n(t,i,a)}}):n(t,i,a)}(this,e,t,a)}}},u.fn.vstwindow.methods={open:function(e,t){o(e)},close:function(e,t){f(e)}}}(jQuery),function(t){t(function(){VST.initLayDateManual(window.document)}),VST.initLayDateManual=function(e){!function(e){t(e).find(".laydate-vst").each(function(){var e=Common.parseDataOptions(this),t=Common.parseEvent(e.done),i=Common.parseEvent(e.change);Common.isFunction(t)&&(e.done=t),Common.isFunction(i)&&(e.change=i),e.elem=this,laydate.render(e)})}(e)}}(jQuery),function(V){VST.initComboxDM=function(e){!function(l){var e=l.selector,r=l.dmKey,d=l.thisAuto,y=l.onComplete,u=V.custom.combobox.dmAttrName,C=V.custom.combobox.subAttrName,F=V.custom.combobox.supAttrName,D=V.custom.combobox.child,f=dmList||{},S=!1;if(!e||!V(e)||V(e).length<1)y&&y({info:"没有匹配的dom元素"});else{var c=!0;V(e).each(function(){var e=V(this);if(!e.hasClass("combobox-f")&&!e.hasClass("easyui-combobox")){var t=null;if(null!=r?(t=r,e.attr(u,r)):t=e.attr(u),!t)return!0;var i=e.attr("auto");if(t&&(!d||d&&"false"!=i)){var a=[],n=t.split(".");if(n&&n.length<=1)a=f[t];else{for(var o=f[n[0]],s=1;s<n.length;s++)if(n[s]&&""!=n[s]){if(!(o=o[n[s]])){o=[];break}o=o[D]}a=o||[]}!function(e,t,i){var a=Common.getEasyuiDomAttr(e,"valueField"),n=Common.getEasyuiDomAttr(e,"textField"),o=Common.getEasyuiDomAttr(e,"edit"),s=Common.getEasyuiDomAttr(e,"nullField"),l=Common.getEasyuiDomAttr(e,"selectFirst"),r=Common.getEasyuiDomAttr(e,"defaultSelected"),d=null!=l?l:V.custom.combobox.defauleSelectFirst,u=null!=a?a:V.custom.combobox.valueField,f=null!=n?n:V.custom.combobox.textField,c=null!=o?o:V.custom.combobox.editable,m=Common.parseEvent(Common.getEasyuiDomAttr(e,"filter")),p=Common.parseEvent(Common.getEasyuiDomAttr(e,"onChange"));if(p=p||i.onChange,null!=s&&Common.isArray(t)){var h={};h[u]="",h[f]=s,t.unshift(h)}if(m)try{t=t.filter(m)}catch(e){}e.combobox({data:t,height:26,valueField:u,textField:f,editable:c,onChange:function(e,t){var i=V(this);if(p)try{p.call(this,e,t)}catch(e){}I(i,e,!1,p)},onLoadSuccess:function(){r?V(this).combobox("select",r):Common.isNotNull(t)&&0<t.length&&d&&V(this).combobox("select",t[0][u])}}),I(V(e),"",!0,p)}(e,V.extend(!0,[],a),l),c=!1}}}),!c||y&&y({info:"没有匹配的dm数据"})}function I(e,t,i,a){var n=e.attr(C);if(Common.isNotNull(n)){var o=e.parent().find("["+F+"="+n+"]");if(o.length<1&&(o=e.parents("form").find("["+F+"="+n+"]")),Common.isNotNull(o)&&0<o.length){var s=Common.getEasyuiDomAttr(o,"valueField"),l=Common.getEasyuiDomAttr(o,"textField"),r=Common.getEasyuiDomAttr(o,"edit"),d=Common.parseEvent(Common.getEasyuiDomAttr(o,"filter")),u=Common.getEasyuiDomAttr(o,"nullField"),f=Common.getEasyuiDomAttr(o,"selectFirst"),c=null!=f?f:V.custom.combobox.defauleSelectFirst,m=null!=s?s:V.custom.combobox.valueField,p=null!=l?l:V.custom.combobox.textField,h=null!=r?r:V.custom.combobox.editable,v=[];if(null!=u&&Common.isArray(v)){var g={};g[m]="",g[p]=u,v.unshift(g)}if(i)V(o).data("initData")||(V(o).combobox({data:v,height:26,valueField:m,textField:p,editable:h}),I(V(o),"",!0,a));else{for(var b=e.combobox("getData"),x=0;x<b.length;x++){var w=b[x];if(w[m]==t){v=v.concat(w[D]);break}}if(d)try{v=v.filter(d)}catch(e){}o.combobox({data:v,height:26,valueField:m,textField:p,editable:h,onChange:function(e,t){var i=V(this);if(a)try{a.call(this,e,t)}catch(e){}I(i,e,!1,a)},onLoadSuccess:function(){if(V(o).data("initData",!0),Common.isNotNull(v)&&0<v.length&&c){var e=v[0][m];V(this).combobox("select",e)}}})}}}else y&&!S&&(S=!0,y({info:"完成"}))}}(e)},V(function(){if(V.custom.combobox.defauleInit){var e="select["+V.custom.combobox.dmAttrName+"],input["+V.custom.combobox.dmAttrName+"]";VST.initComboxDM({selector:e,dmKey:null,thisAuto:!0,onComplete:function(){}})}})}(jQuery),function(l){var r=null;function i(e,t,i){var n=0,a=e.clone().appendTo(e.parent());a.datagrid({data:[{}],url:"",onLoadSuccess:function(e){var t=l(this),i=t.parents(".datagrid-view").find(".datagrid-body").height(),a=t.parents(".datagrid-view").find(".datagrid-body").find("tr").height();n=Math.floor(i/a)}});var o=t||a.datagrid("options");if(r=o.loadFilter,a.parent().parent().parent(".panel.datagrid").remove(),0<=n){var s=t||{};0<(s.pageSize=n)?s.pageList=function(e){for(var t=[e],i=2;i<=5;i++){var a=i*e;10<a&&(a=10<=e?10*Math.floor(a/10):10*(Math.floor(t[t.length-1]/10)+1)),t.push(a)}return t}(n):(s.pageList=[1],s.pageSize=1),s.onLoadSuccess=s.onLoadSuccess?s.onLoadSuccess:l.fn.datagrid.defaults.onLoadSuccess,s.loadFilter=function(e){return t=t||l(this).datagrid("options"),function(e,t,i){if(!e||!e.rows||e.rows.length>=i)return e;for(var a=e.rows.length,n=0;n<i-a;n++)e.rows.push({});return r?r.call(this,e):e}(e,0,n)},t&&i?e.datagrid(s,i):e.datagrid(s)}}l.fn.vstdatagrid=function(e,t){if(this.is("table"))return 0<l(this).parent().parent().parent(".panel.datagrid").length?e&&t?l(this).datagrid(e,t):e?l(this).datagrid(e):l(this).datagrid():(i(l(this),e,t),l(this).parents(".easyui-layout").layout("resize",{height:"auto",width:"auto"})),l(this)},l.extend(l.fn.datagrid.methods,{getRow:function(e,t){return function(e,t){return null==t||null==t||"number"!=typeof t?null:rowData=l(e).datagrid("getRows")[t]}(e,t)}}),l(function(){l(".vst-easyui-datagrid").each(function(){i(l(this))})})}(jQuery),function(n){var o={keySelectCycle:n.fn.combobox.defaults.keySelectCycle,keySelectPannel:n.fn.combobox.defaults.keySelectPannel,getNextValue:function(e,t,i){if(Common.isNull(t))return"";for(var a=0,n=e.combobox("options").valueField,o=0;o<t.length;o++){if(t[o][n]==i){a=o+1,o==t.length-1&&(a=this.keySelectCycle?0:t.length-1);break}}return t[a][n]},getPrevValue:function(e,t,i){if(Common.isNull(t))return"";for(var a=t.length-1,n=e.combobox("options").valueField,o=0;o<t.length;o++){if(t[o][n]==i){a=o-1,0==o&&(a=this.keySelectCycle?t.length-1:0);break}}return t[a][n]}};n.fn.combobox&&n.extend(n.fn.combobox.defaults.keyHandler,{up:function(e){o.keySelectPannel&&n(this).combobox("showPanel");var t=n(e.data.target).combobox("getData"),i=n(e.data.target).combobox("getValue"),a=o.getPrevValue(n(this),t,i);n(this).combobox("select",a)},down:function(e){o.keySelectPannel&&n(this).combobox("showPanel");var t=n(e.data.target).combobox("getData"),i=n(e.data.target).combobox("getValue"),a=o.getNextValue(n(this),t,i);n(this).combobox("select",a)}})}(jQuery),function(s){s(function(){VST.initDateBoxManual(window.document)}),VST.initDateBoxManual=function(e){!function(e){s.fn.validatebox&&s.extend(s.fn.datebox.defaults.keyHandler,{enter:function(e){}}),s(e).find(".easyui-datebox").datebox({onShowPanel:function(){var e=s(this);l.showcalendar||l.tempShow||(e.datebox("hidePanel"),l.calendarOpenStatus=!1)}}),s(e).find(".easyui-datebox").next("span.combo.datebox").on("click","span.textbox-addon",function(e){var t=s(this);t.parent().hasClass("textbox-disabled")||(l.calendarOpenStatus?(t.parent().prev(".easyui-datebox").datebox("hidePanel"),l.calendarOpenStatus=!1):(l.tempShow=!0,t.parent().prev(".easyui-datebox").datebox("showPanel"),l.calendarOpenStatus=!0,setTimeout(function(){l.tempShow=!1},500)))}),s(e).find(".easyui-datebox").next("span.combo.datebox").on("keyup","input.textbox-text",function(e){var t=s(this),i=t.val(),a=l.replaceSpechars(i);if(a=l.getFormatVal(a,e),l.putVal(t,a),Common.isNotNull(a)){var n=a.split(l.separator),o=t.parent().prev(".easyui-datebox").datebox("calendar");setTimeout(function(){var e=l.getCompleteVal(a);0<n[0].length?(1==n[0].length?e="000"+e:2==n[0].length&&(e="00"+e),e=e.replace(new RegExp("[\\"+l.separator+"]","g"),"-"),o.calendar("moveTo",new Date(e))):o.calendar("moveTo",new Date)},200)}13!==e.which||s.custom.enterSwitchFocus.enable||(Common.isNull(a)&&(a=(new Date).format("yyyy"+l.separator+"MM"+l.separator+"dd")),l.putVal(t,l.getCompleteVal(a)),t.parent().prev(".easyui-datebox").datebox("hidePanel"))}).on("blur","input.textbox-text",function(){var e=s(this),t=e.val();t=l.getCompleteVal(t),l.putVal(e,t)})}(e)};var l={separator:s.fn.datebox.defaults.separator,showcalendar:s.fn.datebox.defaults.showcalendar,tempShow:s.fn.datebox.defaults.showcalendar,calendarOpenStatus:!1,getFormatVal:function(e,t){var i=e.split(this.separator);return Common.isNotNull(i)&&(i.length<4&&0<i.length?e=this.valiDate(i,t):4<=i.length&&(e=this.valiDate(i.slice(0,3),t))),e.replace(/[NaN,undefined,null]/g,"")},valiDate:function(e,t){return 1<(e=this.valiYear(e,t)).length&&(e=this.valiMonth(e,t)),2<e.length&&(e=this.valiDay(e,t)),e.join(this.separator)},valiYear:function(e,t){var i=e[0],a=i;if(4<a.length){i=a.substring(0,4);var n=a.substring(4,a.length);1<e.length?(n+=e[1],e[1]=n):e.push(n)}return e[0]=i,e},valiMonth:function(e,t){var i=e[1],a=i;if(2<a.length){i=a.substring(0,2);var n=a.substring(2,a.length);2<e.length?(n+=e[2],e[2]=n):e.push(n)}return 1==i.length&&(1<parseInt(i)||2<e.length)?i="0"+i:2==i.length&&(i=12<parseInt(i)?"12":i,0==parseInt(i)&&(i="01")),2<e.length&&0==parseInt(i)&&(i="01"),e[1]=i,e},valiDay:function(e,t){var i=e[2];2<i.length&&(i=i.substring(0,2));var a=Common.getCountDays(e[0],e[1]);return 1==i.length&&3<parseInt(i)?i="0"+i:2==i.length&&(i=parseInt(i)>a?a:i,0==parseInt(i)&&(i="01")),e[2]=i,e},getCompleteVal:function(e){if(""==e)return e;var t=e.split(this.separator);return 1==t.length?(t.push("01"),t.push("01")):2==t.length?(t[1]=""==t[1]?"1":parseInt(t[1]),t[1]=0==parseInt(t[1])?"01":parseInt(t[1])<10?"0"+t[1]:t[1],t.push("01")):3==t.length&&(t[2]=""==t[2]?"1":parseInt(t[2]),t[2]=0==parseInt(t[2])?"01":parseInt(t[2])<10?"0"+t[2]:t[2]),e=t.join(this.separator)},replaceSpechars:function(e){var t=this;return e.replace(new RegExp("[`~!@#$^&*()=|{}':;',\\\\/.<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？%\\-+_]","g"),t.separator).replace(new RegExp("[^\\d\\"+t.separator+"]","g"),"").replace(new RegExp("[\\"+t.separator+"]{2,}","g"),t.separator).replace(new RegExp("^\\"+t.separator,"g"),"")},putVal:function(e,t){e.val(t),e.next("input[type='hidden'].textbox-value").val(t)}}}(jQuery),function(u){if(u.fn.form){var f={separator:u.fn.datebox.defaults.separator,opts:u.fn.form.defaults,cancelInitialValidate:function(e){var t=u(e);t.form("disableValidation"),t.form("enableValidation"),u("span.textbox-invalid:visible",t).each(function(){u(this).removeClass("textbox-invalid")})},load:function(e,t){if(t){var r={};for(var i in t)r[i.toLowerCase().trim()]=t[i];var d=u(e);u("div.vst-richtext.edui-default",d).each(function(){var e=u(this);try{var t=e.attr("id"),i=UE.getEditor(t),a=i.options.textarea,n=r[a.toLowerCase().trim()];i.initData=n,i.setContent(n)}catch(e){}}),u("input:not([type=file])input[name],textArea[name],select[name],[textboxName],[sliderName],[switchbuttonName],span.load-too",d).each(function(){var t=u(this);if(t.attr("switchbuttonname")){var e=t.attr("switchbuttonname"),i=e.substring(e.indexOf("-")+1,e.length);!(l=r[i.toLowerCase().trim()])&&0!=l||f.checkSwitchbutton(d.find('[switchbuttonName="'+e+'"]'),l)}else if(!this.name||"radio"!=this.type&&"checkbox"!=this.type){if(t.attr("textboxname")||t.attr("slidername")){var a=t.attr("textboxname")||t.attr("slidername");i=a.substring(a.indexOf("-")+1,a.length);if((l=r[i.toLowerCase().trim()])||0==l)if(t.hasClass("datebox-f"))try{var n=new Date(l).format("yyyy"+u.fn.datebox.defaults.separator+"MM"+u.fn.datebox.defaults.separator+"dd");t.datebox("setValue",n)}catch(e){f.loadBox(d.find('[textboxname="'+a+'"],[slidername="'+a+'"]'),l)}else f.loadBox(d.find('[textboxname="'+a+'"],[slidername="'+a+'"]'),l)}else if(t.hasClass("laydate-vst")||t.hasClass("laydate")){i=this.name.substring(this.name.indexOf("-")+1,this.name.length);if(l=r[i.toLowerCase().trim()]){var o=Common.getEasyuiDomAttr(t,"format");if(o)try{t.val(new Date(l).format(o))}catch(e){t.val(l)}else t.val(l)}}else if(this.name){i=this.name.substring(this.name.indexOf("-")+1,this.name.length);!(l=r[i.toLowerCase().trim()])&&0!=l||t.val(l)}else if(t.is("span")&&t.hasClass("load-too")){var s=t.attr("name");i=s.substring(s.indexOf("-")+1,s.length);!(l=r[i.toLowerCase().trim()])&&0!=l||t.text(l)}}else{var l,i=this.name.substring(this.name.indexOf("-")+1,this.name.length);!(l=r[i.toLowerCase().trim()])&&0!=l||f.checkSelect(d.find('input[name="'+this.name+'"][type=radio], input[name="'+this.name+'"][type=checkbox]'),l)}}),f.opts.onLoadSuccess.call(e,t),d.form("validate")}},resetAll:function(e){u(e).form("reset"),u(e).find("span.load-too").text("")},checkSwitchbutton:function(e,t){e.switchbutton("uncheck"),e.each(function(){f.isChecked(u(this).switchbutton("options").value,t)&&u(this).switchbutton("check")})},checkSelect:function(e,t){e._propAttr("checked",!1),e.each(function(){f.isChecked(u(this).val(),t)&&u(this)._propAttr("checked",!0)})},loadBox:function(e,t){for(var i=0;i<f.opts.fieldTypes.length;i++){var a=f.opts.fieldTypes[i],n=e.data(a);if(n)return n.options.multiple||n.options.range?e[a]("setValues",t):e[a]("setValue",t),!0}},isChecked:function(e,t){return e==String(t)||0<=u.inArray(e,u.isArray(t)?t:[t])},validateAndWarn:function(e,i,a){var t=u(e);t.find(".validatebox-text:not(:disabled)").validatebox("validate");var n=t.find(".validatebox-invalid:visible");Common.isNotNull(n)&&0<n.length&&n.each(function(){var e=u(this);if(a){var t=u.data(this,"validatebox").message;t==u.fn.validatebox.defaults.missingMessage&&(t=u.fn.validatebox.defaults.missingMsgForce),u.fn.validatebox.defaults.err(this,t,"show")}i&&setTimeout(function(){e.addClass(u.custom.form.warnStyle),e.parent().addClass(u.custom.form.parentWarnStyle)},200)});var o=0==n.length;return o||setTimeout(function(){n.filter(":not(:disabled):visible:first").get(0).focus()},200),o},addShadow:function(e){var t=u(e);if(!t.attr("shadeAttr")){var i="shade"+(new Date).getTime()+Math.floor(100*(9*Math.random()+1));t.attr("shadeAttr",i);var a=t.offset(),n=t.outerWidth(),o=t.outerHeight(),s=u("<div>").addClass(i).css({position:"absolute",top:a.top+"px",left:a.left+"px",width:n+"px",height:o+"px","z-index":99999999999,"background-color":"#323232",opacity:.18,filter:"alpha(opacity=18)","-moz-opacity":.18,"-khtml-opacity":.18,cursor:"not-allowed"});t.parent().append(s)}},removeShadow:function(e){var t=u(e),i=t.attr("shadeAttr");t.attr("shadeAttr",null),u("div."+i).remove()},disabledItems:function(e){var t=u(e),i="disableVFlag";u("input:not([type=file])input[name],textArea[name],select[name],[textboxName],[sliderName],[switchbuttonName]",t).each(function(){var e=u(this);if(e.attr("switchbuttonname")&&!e.attr("disabled"))e.attr(i,i),t.find('[switchbuttonName="'+switchbuttonName+'"]').switchbutton("disable");else if(!this.name||"radio"!=this.type&&"checkbox"!=this.type||e.attr("disabled"))if(!e.attr("textboxname")&&!e.attr("slidername")||e.attr("disabled"))this.name&&!e.attr("disabled")&&e.attr(i,i).attr("disabled","disabled");else try{e.attr(i,i),e.textbox("disable")}catch(e){console.log("disable easyui form items has a problem!")}else e.attr(i,i),t.find('input[name="'+this.name+'"][type=radio], input[name="'+this.name+'"][type=checkbox]').attr("disabled","disabled")})},enableItems:function(e){var t=u(e),i="disableVFlag";u("input:not([type=file])input[name],textArea[name],select[name],[textboxName],[sliderName],[switchbuttonName]",t).each(function(){var e=u(this);if(e.attr("switchbuttonname")&&e.attr(i)==i)t.find('[switchbuttonName="'+switchbuttonName+'"]').switchbutton("enable");else if(!this.name||"radio"!=this.type&&"checkbox"!=this.type||e.attr(i)!=i)if((e.attr("textboxname")||e.attr("slidername"))&&e.attr(i)==i)try{e.attr(i,i),e.textbox("enable")}catch(e){console.log("disable easyui form items has a problem!")}else this.name&&e.attr(i)==i&&e.attr(i,i).attr("disabled",null);else e.attr(i,i),t.find('input[name="'+this.name+'"][type=radio], input[name="'+this.name+'"][type=checkbox]').attr("disabled",null)})},viewMode:function(e){var t=u(e);u("input:not([type=file])input[name],textArea[name],select[name],[textboxName],[sliderName],[switchbuttonName]",t).each(function(){var e=u(this);if(e.attr("switchbuttonname")){var t="否";e.get(0).checked&&(t="是"),e.next("span.switchbutton").attr("class","view-mode").html(t)}else if(e.attr("textboxname")||e.attr("slidername"))try{t=e.textbox("getText");e.next("span").attr("class","view-mode").html(t)}catch(e){console.log("view mode has a problem!")}else if(this.name){if(e.hide(),e.next().is(".view-mode"))e.next(".view-mode").html(t);else u("<span>").attr("class","view-mode").html(t).insertAfter(e)}})}};u.extend(u.fn.form.methods,{vstLoad:function(e,t){f.load(e,t.data),Common.isValid(t.callback)&&"function"==typeof t.callback&&t.callback()},resetAll:function(e){f.resetAll(e)},serializeObject:function(e){var t=u(e),n={};return u.each(t.serializeArray(),function(e){var t=n[this.name],i=this.value;if(i&&""!=i)if(t){var a=null;Common.isArray(t)?a=t.concat(i):((a=[]).push(t),a.push(i)),n[this.name]=a}else n[this.name]=i}),n},serializeArray:function(e){return u(e).serializeArray()},view:function(e){return f.viewMode(e)},disable:function(e){return f.disabledItems(e)},enable:function(e){return f.enableItems(e)},addShadow:function(e){return f.addShadow(e)},removeShadow:function(e){return f.removeShadow(e)},cancelInitialValidate:function(e){return f.cancelInitialValidate(e)},validateAndWarn:function(e,t,i){return f.validateAndWarn(e,t,i)}})}}(jQuery),function(s){VST.validateErr=function(e,t,i){var a=s(e).validatebox("options");if(a.placeable||null==a.placeable||null==a.placeable){var n=s(e);if(n.hasClass("textbox-text")&&(n=n.parent()),Common.isNotNull(n)&&n.is(":visible")){var o=n.find(".vst-form-validate-error-message");o.length||(o=s('<div class="vst-form-validate-error-message"></div>'),n.append(o)),Common.isNull(t)&&(t=""),a.placeMissOnly?a.missingMessage==t?o.html(t):o.html(""):o.html(t)}}!a.tipable&&null!=a.tipable&&null!=a.tipable||(a.missingMessage==t&&(t=s.fn.validatebox.defaults.missingMsgForce),1==a.isValid?t="":0==a.isValid&&(t=a.forceErrMsg),s.fn.validatebox.defaults.err(e,t,i)),""!=t&&t||(s(e).removeClass(s.custom.form.warnStyle),s(e).parent().removeClass(s.custom.form.parentWarnStyle))}}(jQuery),function(s){s.extend(s.fn.progressbar.methods,{start:function(e){var t=s(e).progressbar("options");!function(t,i){var a=i.estimatedTime||s.fn.progressbar.defaults.estimatedTime,n=null==i.autoComplete?s.fn.progressbar.defaults.autoComplete:i.autoComplete,o=i.intervalTime||s.fn.progressbar.defaults.intervalTime;a<=0||o<=0||!i.estimatedTime||2!=t.data("state")&&t.data("state")||(t.data("state",1),i.interval&&window.clearInterval(i.interval),t.progressbar("options").interval=window.setInterval(function(){var e=t.progressbar("getValue");100<=e?window.clearInterval(i.interval):t.progressbar("setValue",function(e,t,i,a){if(!e||e<=0||i<=0)return a;var n=a;if(t){n=a+(s=100/(e/i))}else{var o=100-a,s=100/(e/i);if(o<.001)n=a;else if(o<=s||o<10){n=a+function(e){{if(8<=e&&e<10)return.1;if(5<=e&&e<8)return.005;if(3<=e&&e<5)return.001;if(2<=e&&e<3)return 5e-4;if(1<=e&&e<2)return 1e-4;if(1.5<=e&&e<2)return 5e-5;if(1<=e&&e<1.5)return 1e-5;if(.5<=e&&e<1)return 1e-6;if(0<=e&&e<.5)return 1e-7}}(o)*o}else n=a+s}return n}(a,n,o,e))},i.intervalTime))}(s(e),t)},pause:function(e){var t=s(e).progressbar("options");!function(e,t){window.clearInterval(t.interval),e.data("state",2)}(s(e),t)},reset:function(e){var t=s(e).progressbar("options");!function(e,t){window.clearInterval(t.interval),e.progressbar("setValue",0),e.data("state",2)}(s(e),t)},complete:function(e){var t=s(e).progressbar("options");!function(e,t){window.clearInterval(t.interval),e.progressbar("setValue",100),e.data("state",2)}(s(e),t)}})}(jQuery);